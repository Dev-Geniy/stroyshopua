<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Samostroy ‚Ä¢ Content Generator PRO</title>

  <link rel="icon" type="image/png" href="../favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    :root{
      --bg:#050509;
      --bg2:#080913;
      --card:#11131c;
      --card2:#151822;
      --ink:#f5f5f7;
      --muted:#9aa0b3;
      --line:rgba(255,255,255,.12);
      --shadow:0 16px 36px rgba(0,0,0,.55);

      --accent:#ff7a1a;
      --accent2:#ffb347;
      --grad:linear-gradient(135deg,#ff7a1a,#ffb347);

      --ok:#5ce3a0;
      --bad:#ff5c77;
      --info:#6aa7ff;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,"Segoe UI",sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(255,122,26,.16), transparent 60%),
        radial-gradient(900px 600px at 90% 0%, rgba(168,85,247,.10), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg));
      background-attachment:fixed;
      min-height:100vh;
    }

    .wrap{max-width:1180px;margin:0 auto;padding:0 14px;}
    header{
      position:sticky;top:0;z-index:80;
      background:rgba(5,5,9,.82);
      backdrop-filter:blur(12px);
      border-bottom:1px solid var(--line);
    }
    .h{
      height:64px;display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .brand{display:flex;align-items:center;gap:12px;min-width:0;}
    .logo{
      width:42px;height:42px;border-radius:16px;border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      display:flex;align-items:center;justify-content:center;
    }
    .logo i{width:20px;height:20px;color:var(--accent2)}
    .title{display:flex;flex-direction:column;line-height:1.1;min-width:0;}
    .title small{
      color:var(--muted);font-size:11.8px;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }
    .title b{
      font-size:13.8px;font-weight:900;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }
    .topActions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end;}
    .pill{
      padding:8px 10px;border-radius:999px;border:1px solid var(--line);
      background:rgba(255,255,255,.03);color:var(--muted);
      font-size:12px;display:flex;align-items:center;gap:8px;white-space:nowrap;
    }
    .pill i{width:16px;height:16px;color:var(--accent2)}
    .btn{
      border:none;cursor:pointer;border-radius:999px;padding:11px 14px;
      font-weight:900;font-size:13.2px;display:inline-flex;align-items:center;gap:8px;
      background:var(--grad);color:#0b0b10;box-shadow:0 14px 26px rgba(0,0,0,.30);
      text-decoration:none;
    }
    .btn.secondary{
      background:rgba(255,255,255,.06);border:1px solid var(--line);
      color:var(--ink);box-shadow:none;
    }
    .btn.ghost{
      background:transparent;border:1px solid rgba(255,255,255,.16);
      color:var(--ink);box-shadow:none;
    }
    .btn i{width:18px;height:18px}
    @media (max-width:720px){
      .pill{display:none}
      .h{height:auto;padding:10px 0}
    }

    main{padding:18px 0 44px}

    .hero{
      border:1px solid var(--line);
      background:rgba(17,19,28,.78);
      border-radius:26px;
      box-shadow:var(--shadow);
      padding:22px;
      position:relative;
      overflow:hidden;
    }
    .hero::after{
      content:"";position:absolute;inset:-40px;
      background:
        radial-gradient(circle at 0 0, rgba(255,179,71,.18), transparent 55%),
        radial-gradient(circle at 90% 10%, rgba(106,167,255,.10), transparent 50%);
      opacity:.9;pointer-events:none;
    }
    h1{
      position:relative;z-index:1;
      margin:0 0 10px;
      font-size:clamp(30px,4.6vw,48px);
      font-weight:900;letter-spacing:-.03em;
      background:var(--grad);
      -webkit-background-clip:text;color:transparent;
      line-height:1.05;
    }
    .lead{
      position:relative;z-index:1;
      margin:0;color:rgba(245,245,247,.90);
      font-size:15px;line-height:1.9;max-width:98ch;
    }
    .chips{
      position:relative;z-index:1;
      margin-top:14px;display:flex;flex-wrap:wrap;gap:8px;
    }
    .chip{
      padding:8px 10px;border-radius:999px;border:1px solid var(--line);
      background:rgba(255,255,255,.03);color:var(--muted);
      font-size:12px;display:flex;align-items:center;gap:7px;
    }
    .chip i{width:16px;height:16px;color:var(--accent2)}

    .layout{
      margin-top:14px;
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }
    @media (min-width:980px){
      .layout{grid-template-columns:420px 1fr}
    }

    .panel{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:22px;
      padding:14px;
    }
    .panelHead{
      display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
      margin-bottom:10px;
    }
    .panelHead b{
      font-size:14px;
      display:flex;align-items:center;gap:9px;
    }
    .panelHead b i{width:18px;height:18px;color:var(--accent2)}
    .panelHead small{
      color:var(--muted);
      display:block;
      margin-top:2px;
      font-size:12.6px;
      line-height:1.5;
    }

    .section{
      border-top:1px solid rgba(255,255,255,.10);
      padding-top:12px;
      margin-top:12px;
    }
    .section:first-child{border-top:none;padding-top:0;margin-top:0}
    .secTitle{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      cursor:pointer;
      user-select:none;
    }
    .secTitle b{
      font-size:13.2px;
      font-weight:900;
      display:flex;align-items:center;gap:8px;
    }
    .secTitle b i{width:16px;height:16px;color:var(--accent2)}
    .secTitle .hintTag{
      font-size:11px;color:var(--muted);padding:3px 8px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.28);white-space:nowrap;
    }
    .secBody{margin-top:10px;display:none}
    .section.open .secBody{display:block}

    label{
      display:block;
      color:var(--muted);
      font-size:12.5px;
      margin:10px 0 6px;
    }
    input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.22);
      color:var(--ink);
      outline:none;
      font-family:inherit;
      font-size:14px;
    }
    textarea{min-height:92px;resize:vertical}
    input::placeholder, textarea::placeholder{color:rgba(154,160,179,.75)}
    .row{display:grid;grid-template-columns:1fr;gap:10px}
    @media (min-width:980px){
      .row.two{grid-template-columns:1fr 1fr}
      .row.three{grid-template-columns:1fr 1fr 1fr}
    }

    .micro{
      color:var(--muted);
      font-size:12.5px;
      line-height:1.6;
      margin-top:8px;
    }
    .micro b{color:rgba(245,245,247,.92)}
    .kbd{
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12px;
      padding:2px 6px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.25);
      color:rgba(245,245,247,.92);
      white-space:nowrap;
    }

    .tabs{
      display:flex;gap:8px;flex-wrap:wrap;
      margin-top:8px;
    }
    .tab{
      padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.20);
      color:var(--muted);
      font-size:12.5px;
      cursor:pointer;
      display:flex;align-items:center;gap:8px;
    }
    .tab i{width:16px;height:16px;color:var(--accent2)}
    .tab.active{
      color:#0b0b10;
      background:var(--grad);
      border-color:transparent;
      font-weight:900;
    }
    .tab.active i{color:#0b0b10}

    .outArea{margin-top:12px}
    .outTop{
      display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      border-radius:18px;
      padding:12px;
    }
    .outTop b{font-size:13.6px}
    .outTop small{color:var(--muted);font-size:12.5px;line-height:1.5}
    .outBtns{display:flex;gap:10px;flex-wrap:wrap}
    .toast{
      position:fixed;
      bottom:16px;
      left:50%;
      transform:translateX(-50%);
      background:rgba(17,19,28,.92);
      border:1px solid rgba(255,255,255,.14);
      padding:10px 12px;
      border-radius:14px;
      color:rgba(245,245,247,.92);
      font-size:13px;
      display:none;
      z-index:200;
      box-shadow:0 18px 40px rgba(0,0,0,.45);
      max-width:92vw;
    }

    .kpis{
      margin-top:12px;
      display:grid;grid-template-columns:1fr;gap:10px;
    }
    @media (min-width:760px){ .kpis{grid-template-columns:1fr 1fr 1fr} }
    .kpi{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      border-radius:18px;
      padding:14px;
      position:relative;
      overflow:hidden;
    }
    .kpi::after{
      content:"";position:absolute;inset:-30px;
      background:radial-gradient(circle at 0 0, rgba(255,255,255,.10), transparent 55%);
      opacity:.55;pointer-events:none;
    }
    .kpi small{
      position:relative;z-index:1;
      color:var(--muted);display:flex;align-items:center;gap:8px;
      font-size:12.5px;
    }
    .kpi small i{width:16px;height:16px;color:var(--accent2)}
    .kpi b{
      position:relative;z-index:1;
      display:block;margin-top:8px;
      font-size:18px;font-weight:900;
      color:var(--accent2);
    }

    .tableWrap{
      margin-top:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      border-radius:18px;
      overflow:hidden;
    }
    table{width:100%;border-collapse:collapse}
    th,td{
      padding:10px 10px;
      border-bottom:1px solid rgba(255,255,255,.08);
      font-size:13px;
      vertical-align:top;
    }
    th{
      color:var(--muted);
      font-weight:700;
      text-align:left;
      background:rgba(255,255,255,.03);
    }
    tr:last-child td{border-bottom:none}
    tr.rowBtn{cursor:pointer}
    tr.rowBtn:hover td{background:rgba(255,255,255,.03)}
    .tag{
      display:inline-flex;align-items:center;gap:6px;
      font-size:11.5px;color:var(--muted);
      padding:3px 8px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.28);
      white-space:nowrap;
    }
    .tag i{width:14px;height:14px;color:var(--accent2)}
    .miniText{color:var(--muted);font-size:12.5px;line-height:1.55;margin-top:8px}

    .block{
      margin-top:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      border-radius:18px;
      padding:12px;
    }
    .blockHead{
      display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;
    }
    .blockHead b{font-size:13.6px;display:flex;align-items:center;gap:8px}
    .blockHead b i{width:16px;height:16px;color:var(--accent2)}
    .mono{
      margin-top:10px;
      border:1px dashed rgba(255,255,255,.22);
      background:rgba(0,0,0,.25);
      border-radius:18px;
      padding:12px;
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12.6px;
      color:rgba(245,245,247,.92);
      line-height:1.65;
      white-space:pre-wrap;
      word-break:break-word;
    }

    .drawer{
      position:fixed;inset:0;
      background:rgba(0,0,0,.55);
      display:none;align-items:flex-end;justify-content:center;
      z-index:150;
      padding:12px;
    }
    .sheet{
      width:min(980px, 98vw);
      max-height:86vh;
      overflow:auto;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(17,19,28,.96);
      border-radius:22px;
      box-shadow:0 26px 60px rgba(0,0,0,.55);
      padding:14px;
    }
    .sheetTop{
      display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      padding-bottom:10px;
      margin-bottom:10px;
    }
    .sheetTop b{font-size:15px}
    .sheetTop small{color:var(--muted);display:block;margin-top:4px;line-height:1.5}
    .closeX{
      width:40px;height:40px;border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.22);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;
    }
    .closeX i{width:18px;height:18px;color:var(--accent2)}
    .twoCols{
      display:grid;grid-template-columns:1fr;gap:12px;
    }
    @media (min-width:980px){ .twoCols{grid-template-columns:1fr 1fr} }

    footer{
      margin-top:18px;border-top:1px solid rgba(255,255,255,.10);
      padding:16px 0 22px;text-align:center;color:var(--muted);font-size:12px;
    }
    .mutedLink{
      color:var(--muted);text-decoration:none;border-bottom:1px dashed rgba(255,255,255,.25)
    }
    .mutedLink:hover{color:rgba(245,245,247,.92);border-bottom-color:rgba(255,255,255,.4)}
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <div class="h">
      <div class="brand">
        <div class="logo" title="Content Generator PRO"><i data-lucide="wand-2"></i></div>
        <div class="title">
          <small>Samostroy ‚Ä¢ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è TikTok / Reels / Shorts</small>
          <b>Content Generator PRO ‚Äî –ø–ª–∞–Ω, —Å–∫—Ä–∏–ø—Ç–∏, CTA, —Ö–µ—à—Ç–µ–≥–∏, –µ–∫—Å–ø–æ—Ä—Ç</b>
        </div>
      </div>

      <div class="topActions">
        <div class="pill" id="statePill"><i data-lucide="save"></i><span>–°—Ç–∞–Ω: –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ</span></div>
        <button class="btn secondary" id="btnQuickStart" type="button"><i data-lucide="sparkles"></i> –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç</button>
        <button class="btn" id="btnGenerate" type="button"><i data-lucide="wand-2"></i> –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="hero">
    <h1>–ó—Ä–æ–±–∏ –∫–æ–Ω—Ç–µ–Ω—Ç —Å–∏—Å—Ç–µ–º–æ—é ‚Äî —ñ –ø–µ—Ä–µ—Å—Ç–∞–Ω—å –¥—É–º–∞—Ç–∏ ‚Äú—â–æ –∑–Ω—ñ–º–∞—Ç–∏ –∑–∞–≤—Ç—Ä–∞‚Äù</h1>
    <p class="lead">
      –¶–µ –æ–∫—Ä–µ–º–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä. –í–æ–Ω–∞ –±–µ—Ä–µ —Ç–≤–æ—ó –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞—î <b>–≥–æ—Ç–æ–≤–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä</b> (7/14/30 –¥–Ω—ñ–≤),
      <b>–≥–∞—á–∫–∏</b>, <b>—Å–∫—Ä–∏–ø—Ç–∏</b>, <b>—Ç–µ–∫—Å—Ç –Ω–∞ –µ–∫—Ä–∞–Ω—ñ</b>, <b>—Å–ø–∏—Å–æ–∫ –∫–∞–¥—Ä—ñ–≤</b>, <b>–ø—ñ–¥–ø–∏—Å</b>, <b>CTA –≤ –¥—ñ—Ä–µ–∫—Ç</b>,
      <b>—à–∞–±–ª–æ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</b> —ñ <b>–µ–∫—Å–ø–æ—Ä—Ç</b> —É TXT/CSV/JSON.
      <br><br>
      –î–ª—è –Ω–æ–≤–∞—á–∫–∞: –ø—Ä–æ—Å—Ç–æ –∑—Ä–æ–±–∏ 3 –∫—Ä–æ–∫–∏ ‚Äî <span class="kbd">1) —Ç–æ–≤–∞—Ä</span> ‚Üí <span class="kbd">2) CTA-—Å–ª–æ–≤–æ</span> ‚Üí <span class="kbd">3) –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</span>.
    </p>
    <div class="chips">
      <div class="chip"><i data-lucide="calendar-days"></i> –ü–ª–∞–Ω 7/14/30 –¥–Ω—ñ–≤</div>
      <div class="chip"><i data-lucide="film"></i> –°–∫—Ä–∏–ø—Ç + –∫–∞–¥—Ä–∏ + —Ç–µ–∫—Å—Ç</div>
      <div class="chip"><i data-lucide="message-circle"></i> CTA + DM-–≤—ñ–¥–ø–æ–≤—ñ–¥—å</div>
      <div class="chip"><i data-lucide="download"></i> –ï–∫—Å–ø–æ—Ä—Ç (TXT/CSV/JSON)</div>
    </div>
  </section>

  <div class="layout">
    <!-- LEFT: SETTINGS -->
    <aside class="panel">
      <div class="panelHead">
        <div>
          <b><i data-lucide="sliders-horizontal"></i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞</b>
          <small>–ü–æ—Ä–∞–¥–∞: –≤—ñ–¥–∫—Ä–∏–≤–∞–π –±–ª–æ–∫–∏ –∑–ª—ñ–≤–∞ —ñ –∑–∞–ø–æ–≤–Ω—é–π –∑–≤–µ—Ä—Ö—É –≤–Ω–∏–∑. –ú–æ–∂–Ω–∞ –ª–∏—à–∏—Ç–∏ –≤—Å–µ ‚Äú–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º‚Äù.</small>
        </div>
        <button class="btn ghost" id="btnReset" type="button" title="–°–∫–∏–Ω—É—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"><i data-lucide="rotate-ccw"></i></button>
      </div>

      <!-- Section: Project -->
      <div class="section open" data-sec="project">
        <div class="secTitle">
          <b><i data-lucide="folder"></i> –ü—Ä–æ—î–∫—Ç (–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è)</b>
          <span class="hintTag">–≤–∞–∂–ª–∏–≤–æ</span>
        </div>
        <div class="secBody">
          <label for="projectName">–ù–∞–∑–≤–∞ –ø—Ä–æ—î–∫—Ç—É</label>
          <input id="projectName" placeholder="–ù–∞–ø—Ä.: –ü–∞–Ω–µ–ª—ñ / OLX / –ö–∏—ó–≤" />

          <div class="row two">
            <div>
              <label for="projectSelect">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π</label>
              <select id="projectSelect"></select>
            </div>
            <div>
              <label>&nbsp;</label>
              <button class="btn secondary" id="btnLoadProject" type="button"><i data-lucide="folder-open"></i> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>
            </div>
          </div>

          <div class="row two">
            <button class="btn" id="btnSaveProject" type="button"><i data-lucide="save"></i> –ó–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ—î–∫—Ç</button>
            <button class="btn secondary" id="btnDeleteProject" type="button"><i data-lucide="trash-2"></i> –í–∏–¥–∞–ª–∏—Ç–∏</button>
          </div>

          <div class="micro">
            <b>–©–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è:</b> —Ç–≤–æ—ó –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è + –æ—Å—Ç–∞–Ω–Ω—ñ–π –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –ø–ª–∞–Ω (—É –±—Ä–∞—É–∑–µ—Ä—ñ).
          </div>
        </div>
      </div>

      <!-- Section: Basics -->
      <div class="section open" data-sec="basics">
        <div class="secTitle">
          <b><i data-lucide="target"></i> –û—Å–Ω–æ–≤–∞ (–æ–±–æ–≤ º—è–∑–∫–æ–≤–æ)</b>
          <span class="hintTag">3 –ø–æ–ª—è</span>
        </div>
        <div class="secBody">
          <div class="row two">
            <div>
              <label for="platform">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</label>
              <select id="platform">
                <option value="TikTok">TikTok</option>
                <option value="Reels (Instagram)">Reels (Instagram)</option>
                <option value="YouTube Shorts">YouTube Shorts</option>
                <option value="TikTok + Reels">TikTok + Reels</option>
              </select>
            </div>
            <div>
              <label for="language">–ú–æ–≤–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É</label>
              <select id="language">
                <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
              </select>
            </div>
          </div>

          <label for="product">–¢–æ–≤–∞—Ä / –Ω—ñ—à–∞ (–ø—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏)</label>
          <input id="product" placeholder="–ù–∞–ø—Ä.: 3D –ø–∞–Ω–µ–ª—ñ / –≤—ñ–Ω—ñ–ª–æ–≤—ñ –ø–∞–Ω–µ–ª—ñ / –ø–∞–∑–ª–∏-–∫–∏–ª–∏–º–∫–∏" />

          <label for="ctaWord">CTA-—Å–ª–æ–≤–æ –¥–ª—è –¥—ñ—Ä–µ–∫—Ç—É (1 —Å–ª–æ–≤–æ)</label>
          <input id="ctaWord" placeholder="–ù–∞–ø—Ä.: –•–û–ß–£" />

          <div class="row two">
            <div>
              <label for="region">–†–µ–≥—ñ–æ–Ω (–æ–ø—Ü—ñ–π–Ω–æ)</label>
              <input id="region" placeholder="–ù–∞–ø—Ä.: –£–∫—Ä–∞—ó–Ω–∞ / –ö–∏—ó–≤ / –õ—å–≤—ñ–≤" />
            </div>
            <div>
              <label for="goal">–ì–æ–ª–æ–≤–Ω–∞ —Ü—ñ–ª—å</label>
              <select id="goal">
                <option value="messages">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–∑–∞—è–≤–∫–∏)</option>
                <option value="comments">–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ + –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è</option>
                <option value="reach">–û—Ö–æ–ø–ª–µ–Ω–Ω—è (–ø–µ—Ä–µ–≥–ª—è–¥–∏)</option>
              </select>
            </div>
          </div>

          <div class="micro">
            <b>–Ø–∫ –ø—Ä–∞—Ü—é—î CTA-—Å–ª–æ–≤–æ:</b> —É –≤—ñ–¥–µ–æ –∫–∞–∂–µ—à ‚Äú–ù–∞–ø–∏—à–∏ <span class="kbd">—Å–ª–æ–≤–æ</span> ‚Äî —Å–∫–∏–Ω—É –≤–∞—Ä—ñ–∞–Ω—Ç–∏/–ø—Ä–æ—Ä–∞—Ö—É–Ω–æ–∫‚Äù.
            –õ—é–¥–∏ –ø–∏—à—É—Ç—å —Å–ª–æ–≤–æ ‚Üí —Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î—à —à–∞–±–ª–æ–Ω–æ–º (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–∞—Å—Ç—å –≥–æ—Ç–æ–≤–∏–π —Ç–µ–∫—Å—Ç).
          </div>
        </div>
      </div>

      <!-- Section: Audience & Offer -->
      <div class="section" data-sec="audience">
        <div class="secTitle">
          <b><i data-lucide="users"></i> –ê—É–¥–∏—Ç–æ—Ä—ñ—è + –æ—Ñ–µ—Ä (—â–æ–± –±—É–ª–æ ‚Äú–≤–ª—É—á–Ω–æ‚Äù)</b>
          <span class="hintTag">—Å–∏–ª—å–Ω–æ –ø—ñ–¥–≤–∏—â—É—î</span>
        </div>
        <div class="secBody">
          <div class="row two">
            <div>
              <label for="audience">–ö–æ–º—É –ø—Ä–æ–¥–∞—î—à?</label>
              <select id="audience">
                <option value="homeowners">–í–ª–∞—Å–Ω–∏–∫–∏ –∫–≤–∞—Ä—Ç–∏—Ä/–±—É–¥–∏–Ω–∫—ñ–≤</option>
                <option value="renters">–û—Ä–µ–Ω–¥–∞—Ä—ñ (—à–≤–∏–¥–∫–æ/–¥–µ—à–µ–≤–æ)</option>
                <option value="designers">–î–∏–∑–∞–π–Ω–µ—Ä–∏/–º–∞–π—Å—Ç—Ä–∏</option>
                <option value="biz">B2B (–º–∞–≥–∞–∑–∏–Ω–∏/–ø–∞—Ä—Ç–Ω–µ—Ä–∏)</option>
              </select>
            </div>
            <div>
              <label for="priceLevel">–ü–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è</label>
              <select id="priceLevel">
                <option value="value">–í–∏–≥—ñ–¥–Ω–æ/—Ä–æ–∑—É–º–Ω–∞ —Ü—ñ–Ω–∞</option>
                <option value="mid">–°–µ—Ä–µ–¥–Ω—ñ–π —Å–µ–≥–º–µ–Ω—Ç</option>
                <option value="premium">–ü—Ä–µ–º—ñ—É–º/–¥–æ—Ä–æ–≥–æ –≤–∏–≥–ª—è–¥–∞—î</option>
              </select>
            </div>
          </div>

          <label for="offer">–¢–≤—ñ–π –æ—Ñ–µ—Ä (1-2 —Ä–µ—á–µ–Ω–Ω—è)</label>
          <textarea id="offer" placeholder="–ù–∞–ø—Ä.: –ü—ñ–¥–±–µ—Ä—É –ø–∞–Ω–µ–ª—ñ –ø—ñ–¥ –≤–∞—à—É –ø–ª–æ—â—É, —Å–∫–∏–Ω—É —Ñ–æ—Ç–æ/–≤—ñ–¥–µ–æ –≤–∂–∏–≤—É, –ø—Ä–æ—Ä–∞—Ö—É—é –¥–æ—Å—Ç–∞–≤–∫—É."></textarea>

          <div class="row two">
            <div>
              <label for="proof">–î–æ–≤—ñ—Ä–∞ (—â–æ —î?)</label>
              <select id="proof">
                <option value="basic">–§–æ—Ç–æ/–≤—ñ–¥–µ–æ –≤–∂–∏–≤—É</option>
                <option value="reviews">–í—ñ–¥–≥—É–∫–∏/–∫–µ–π—Å–∏</option>
                <option value="guarantee">–ì–∞—Ä–∞–Ω—Ç—ñ—è/–æ–±–º—ñ–Ω</option>
                <option value="all">–í—Å–µ —Ä–∞–∑–æ–º</option>
              </select>
            </div>
            <div>
              <label for="objection">–ì–æ–ª–æ–≤–Ω–µ –∑–∞–ø–µ—Ä–µ—á–µ–Ω–Ω—è</label>
              <select id="objection">
                <option value="price">–¶—ñ–Ω–∞</option>
                <option value="quality">–Ø–∫—ñ—Å—Ç—å/—è–∫ –≤–∏–≥–ª—è–¥–∞—î –≤–∂–∏–≤—É</option>
                <option value="installation">–ú–æ–Ω—Ç–∞–∂/—Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å</option>
                <option value="delivery">–î–æ—Å—Ç–∞–≤–∫–∞/—Ç–µ—Ä–º—ñ–Ω–∏/–æ–ø–ª–∞—Ç–∞</option>
                <option value="fit">–ß–∏ –ø—ñ–¥—ñ–π–¥–µ (–∫—É—Ö–Ω—è/–≤–∞–Ω–Ω–∞/—Å—Ç—ñ–Ω–∞)</option>
              </select>
            </div>
          </div>

          <div class="micro">
            –Ø–∫—â–æ –æ—Ñ–µ—Ä –ø—É—Å—Ç–∏–π ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—ñ–¥—Å—Ç–∞–≤–∏—Ç—å —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π —à–∞–±–ª–æ–Ω –ø—ñ–¥ —Ç–≤—ñ–π —Ç–æ–≤–∞—Ä.
          </div>
        </div>
      </div>

      <!-- Section: Plan -->
      <div class="section open" data-sec="plan">
        <div class="secTitle">
          <b><i data-lucide="calendar"></i> –ü–ª–∞–Ω (—Å–∫—ñ–ª—å–∫–∏ —ñ –∫–æ–ª–∏)</b>
          <span class="hintTag">–∫–∞–ª–µ–Ω–¥–∞—Ä</span>
        </div>
        <div class="secBody">
          <div class="row three">
            <div>
              <label for="planDays">–ü–µ—Ä—ñ–æ–¥</label>
              <select id="planDays">
                <option value="7">7 –¥–Ω—ñ–≤</option>
                <option value="14" selected>14 –¥–Ω—ñ–≤</option>
                <option value="30">30 –¥–Ω—ñ–≤</option>
              </select>
            </div>
            <div>
              <label for="pace">–¢–µ–º–ø</label>
              <select id="pace">
                <option value="daily">1 –≤—ñ–¥–µ–æ —â–æ–¥–Ω—è</option>
                <option value="5wk">5 –≤—ñ–¥–µ–æ/—Ç–∏–∂–¥–µ–Ω—å (–ø–Ω-–ø—Ç)</option>
                <option value="3wk">3 –≤—ñ–¥–µ–æ/—Ç–∏–∂–¥–µ–Ω—å (–ø–Ω/—Å—Ä/–ø—Ç)</option>
              </select>
            </div>
            <div>
              <label for="lengthSec">–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –≤—ñ–¥–µ–æ</label>
              <select id="lengthSec">
                <option value="12">10‚Äì15 —Å–µ–∫</option>
                <option value="20" selected>15‚Äì25 —Å–µ–∫</option>
                <option value="35">25‚Äì40 —Å–µ–∫</option>
              </select>
            </div>
          </div>

          <div class="row two">
            <div>
              <label for="timeSlot">–ß–∞—Å –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó (–ø—ñ–¥–∫–∞–∑–∫–∞)</label>
              <select id="timeSlot">
                <option value="evening" selected>–í–µ—á—ñ—Ä (18:00‚Äì22:00)</option>
                <option value="noon">–î–µ–Ω—å (12:00‚Äì16:00)</option>
                <option value="morning">–†–∞–Ω–æ–∫ (08:00‚Äì11:00)</option>
              </select>
            </div>
            <div>
              <label for="style">–¢–æ–Ω –ø–æ–¥–∞—á—ñ</label>
              <select id="style">
                <option value="friendly" selected>–î—Ä—É–∂–Ω—å–æ —ñ –ø—Ä–æ—Å—Ç–æ</option>
                <option value="expert">–ï–∫—Å–ø–µ—Ä—Ç–Ω–æ —ñ –≤–ø–µ–≤–Ω–µ–Ω–æ</option>
                <option value="energetic">–ï–Ω–µ—Ä–≥—ñ–π–Ω–æ/—à–≤–∏–¥–∫–æ</option>
                <option value="calm">–°–ø–æ–∫—ñ–π–Ω–æ/–ø—Ä–µ–º—ñ–∞–ª—å–Ω–æ</option>
              </select>
            </div>
          </div>

          <label for="productsList">–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä—ñ–≤ (–æ–ø—Ü—ñ–π–Ω–æ, –ø–æ 1 –Ω–∞ —Ä—è–¥–æ–∫)</label>
          <textarea id="productsList" placeholder="–Ø–∫—â–æ —Ö–æ—á–µ—à —Ä–æ—Ç–∞—Ü—ñ—é:
3D –ø–∞–Ω–µ–ª—ñ
–í—ñ–Ω—ñ–ª–æ–≤—ñ –ø–∞–Ω–µ–ª—ñ
–ü–∞–∑–ª–∏-–∫–∏–ª–∏–º–∫–∏"></textarea>
          <div class="micro">–Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–æ–≤–Ω–µ–Ω–∏–π ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –±—É–¥–µ —á–µ—Ä–≥—É–≤–∞—Ç–∏ —Ç–æ–≤–∞—Ä–∏, —â–æ–± –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ ‚Äú–∑–∞—ó–¥–∞–≤‚Äù.</div>
        </div>
      </div>

      <!-- Section: Filming Constraints -->
      <div class="section" data-sec="shoot">
        <div class="secTitle">
          <b><i data-lucide="video"></i> –ó–π–æ–º–∫–∞ (–æ–±–º–µ–∂–µ–Ω–Ω—è)</b>
          <span class="hintTag">–¥–ª—è —Å–æ—Ä–æ–º—É</span>
        </div>
        <div class="secBody">
          <div class="row two">
            <div>
              <label for="face">–û–±–ª–∏—á—á—è –≤ –∫–∞–¥—Ä—ñ</label>
              <select id="face">
                <option value="no" selected>–ë–µ–∑ –æ–±–ª–∏—á—á—è (—Ä—É–∫–∏/—Ç–æ–≤–∞—Ä)</option>
                <option value="yes">–ú–æ–∂–Ω–∞ –æ–±–ª–∏—á—á—è</option>
              </select>
            </div>
            <div>
              <label for="voice">–ì–æ–ª–æ—Å</label>
              <select id="voice">
                <option value="no" selected>–ë–µ–∑ –≥–æ–ª–æ—Å—É (—Ç–µ–∫—Å—Ç –Ω–∞ –µ–∫—Ä–∞–Ω—ñ)</option>
                <option value="yes">–ú–æ–∂–Ω–∞ –≥–æ–ª–æ—Å/–æ–∑–≤—É—á–∫–∞</option>
              </select>
            </div>
          </div>

          <label for="tools">–©–æ —î –¥–ª—è –∑–π–æ–º–∫–∏?</label>
          <select id="tools">
            <option value="phone" selected>–¢–µ–ª–µ—Ñ–æ–Ω + —Å–≤—ñ—Ç–ª–æ –∫—ñ–º–Ω–∞—Ç–∏</option>
            <option value="ring">–¢–µ–ª–µ—Ñ–æ–Ω + –∫—ñ–ª—å—Ü–µ–≤–∞ –ª–∞–º–ø–∞</option>
            <option value="tripod">–¢–µ–ª–µ—Ñ–æ–Ω + —à—Ç–∞—Ç–∏–≤</option>
            <option value="full">–°–≤—ñ—Ç–ª–æ + —à—Ç–∞—Ç–∏–≤ + —Ñ–æ–Ω</option>
          </select>

          <div class="micro">
            –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∞–¥–∞–ø—Ç—É—î —Å–∫—Ä–∏–ø—Ç–∏: —è–∫—â–æ <b>–±–µ–∑ –≥–æ–ª–æ—Å—É</b> ‚Äî –¥–∞—Å—Ç—å —Å–∏–ª—å–Ω—ñ —Ç–∏—Ç—Ä–∏,
            —è–∫—â–æ <b>–±–µ–∑ –æ–±–ª–∏—á—á—è</b> ‚Äî –¥–∞—Å—Ç—å –∫–∞–¥—Ä–∏ ‚Äú—Ä—É–∫–∏ + —Ç–æ–≤–∞—Ä‚Äù.
          </div>
        </div>
      </div>

      <!-- Section: Advanced -->
      <div class="section" data-sec="advanced">
        <div class="secTitle">
          <b><i data-lucide="sparkles"></i> PRO-–æ–ø—Ü—ñ—ó (—Å—É–ø–µ—Ä)</b>
          <span class="hintTag">optional</span>
        </div>
        <div class="secBody">
          <div class="row two">
            <div>
              <label for="seed">–í–∞—Ä—ñ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å (seed)</label>
              <input id="seed" placeholder="–ó–∞–ª–∏—à –ø–æ—Ä–æ–∂–Ω—ñ–º ‚Äî –±—É–¥–µ –≤–∏–ø–∞–¥–∫–æ–≤–æ" />
              <div class="micro">–û–¥–Ω–∞–∫–æ–≤–∏–π seed = –æ–¥–Ω–∞–∫–æ–≤—ñ —ñ–¥–µ—ó. –ó—Ä—É—á–Ω–æ –¥–ª—è –ø–æ–≤—Ç–æ—Ä—ñ–≤.</div>
            </div>
            <div>
              <label for="focusSeries">–§–æ–∫—É—Å —Å–µ—Ä—ñ–π</label>
              <select id="focusSeries">
                <option value="balanced" selected>–ë–∞–ª–∞–Ω—Å (—Ä–µ–∑—É–ª—å—Ç–∞—Ç/–¥–æ–≤—ñ—Ä–∞/FAQ)</option>
                <option value="sales">–ë—ñ–ª—å—à–µ –ø—Ä–æ–¥–∞–∂–Ω–∏—Ö (—Ä–µ–∑—É–ª—å—Ç–∞—Ç+—Ü—ñ–Ω–∞)</option>
                <option value="trust">–ë—ñ–ª—å—à–µ –¥–æ–≤—ñ—Ä–∏ (–≤–∂–∏–≤—É+–∫–µ–π—Å–∏)</option>
                <option value="faq">–ë—ñ–ª—å—à–µ FAQ/–∑–∞–ø–µ—Ä–µ—á–µ–Ω—å</option>
              </select>
            </div>
          </div>

          <div class="row two">
            <div>
              <label for="hashtagsMode">–•–µ—à—Ç–µ–≥–∏</label>
              <select id="hashtagsMode">
                <option value="smart" selected>–†–æ–∑—É–º–Ω—ñ (–Ω—ñ—à–∞ + –∫–æ–Ω—Ç–µ–Ω—Ç + —Ä–µ–≥—ñ–æ–Ω)</option>
                <option value="minimal">–ú—ñ–Ω—ñ–º—É–º (5‚Äì8)</option>
                <option value="wide">–®–∏—Ä—à–µ (12‚Äì18)</option>
              </select>
            </div>
            <div>
              <label for="ctaMode">CTA-—Å—Ç–∏–ª—å</label>
              <select id="ctaMode">
                <option value="soft" selected>–ú º—è–∫–æ (–ø–æ—Ä–∞–¥–∏—Ç–∏/–ø—ñ–¥–∫–∞–∑–∞—Ç–∏)</option>
                <option value="direct">–ü—Ä—è–º–æ (—Ü—ñ–Ω–∞/–ø—Ä–æ—Ä–∞—Ö—É–Ω–æ–∫)</option>
                <option value="bonus">–ó –±–æ–Ω—É—Å–æ–º (—á–µ–∫-–ª–∏—Å—Ç/–ø—ñ–¥–±—ñ—Ä)</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="section open" data-sec="actions">
        <div class="secTitle">
          <b><i data-lucide="play"></i> –î—ñ—ó</b>
          <span class="hintTag">–Ω–∞—Ç–∏—Å–Ω–∏</span>
        </div>
        <div class="secBody">
          <div class="row two">
            <button class="btn" id="btnGenerate2" type="button"><i data-lucide="wand-2"></i> –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
            <button class="btn secondary" id="btnCopyAll" type="button"><i data-lucide="copy"></i> –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤—Å–µ</button>
          </div>
          <div class="row two">
            <button class="btn secondary" id="btnDownloadTxt" type="button"><i data-lucide="download"></i> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ TXT</button>
            <button class="btn secondary" id="btnDownloadCsv" type="button"><i data-lucide="file-spreadsheet"></i> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ CSV</button>
          </div>
          <button class="btn secondary" id="btnDownloadJson" type="button" style="width:100%"><i data-lucide="braces"></i> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ JSON (–ø—Ä–æ—î–∫—Ç)</button>

          <div class="micro">
            –ü–æ—Ä–∞–¥–∞: —Å–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π ‚Üí –ø–æ—Ç—ñ–º –≤—ñ–¥–∫—Ä–∏–π –≤–∫–ª–∞–¥–∫—É <b>‚Äú–°–∫—Ä–∏–ø—Ç–∏‚Äù</b> —ñ –≤–∏–±–µ—Ä–∏ 4 –≤—ñ–¥–µ–æ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å –¥–ª—è –ø–∞—á–∫–∏ –∑–π–æ–º–∫–∏.
          </div>
        </div>
      </div>
    </aside>

    <!-- RIGHT: OUTPUT -->
    <section class="panel">
      <div class="panelHead">
        <div>
          <b><i data-lucide="layout-template"></i> –†–µ–∑—É–ª—å—Ç–∞—Ç–∏</b>
          <small>–ü–ª–∞–Ω –º–æ–∂–Ω–∞ –Ω–∞—Ç–∏—Å–∫–∞—Ç–∏: –∫–ª—ñ–∫ –ø–æ —Ä—è–¥–∫—É –≤—ñ–¥–∫—Ä–∏—î –¥–µ—Ç–∞–ª—ñ (–≥–∞—á–∫–∏, —Å–∫—Ä–∏–ø—Ç, –∫–∞–¥—Ä–∏, –æ–ø–∏—Å, CTA, DM).</small>
        </div>
      </div>

      <div class="tabs" id="tabs">
        <div class="tab active" data-tab="plan"><i data-lucide="calendar-days"></i> –ü–ª–∞–Ω</div>
        <div class="tab" data-tab="scripts"><i data-lucide="file-text"></i> –°–∫—Ä–∏–ø—Ç–∏</div>
        <div class="tab" data-tab="batch"><i data-lucide="clapperboard"></i> –ü–∞—á–∫–∞-–∑–π–æ–º–∫–∞</div>
        <div class="tab" data-tab="dm"><i data-lucide="message-square"></i> DM / –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</div>
        <div class="tab" data-tab="export"><i data-lucide="download"></i> –ï–∫—Å–ø–æ—Ä—Ç</div>
      </div>

      <div class="outArea">
        <div class="outTop">
          <div>
            <b id="outTitle">–ü–ª–∞–Ω –Ω–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ</b>
            <small id="outSubtitle">–ó–∞–ø–æ–≤–Ω–∏ 2 –ø–æ–ª—è (—Ç–æ–≤–∞—Ä + CTA-—Å–ª–æ–≤–æ) —ñ –Ω–∞—Ç–∏—Å–Ω–∏ ‚Äú–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏‚Äù.</small>
          </div>
          <div class="outBtns">
            <button class="btn secondary" id="btnRegenerate" type="button"><i data-lucide="refresh-cw"></i> –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
            <button class="btn secondary" id="btnCopyTab" type="button"><i data-lucide="copy"></i> –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤–∫–ª–∞–¥–∫—É</button>
          </div>
        </div>

        <div class="kpis" id="kpis" style="display:none;">
          <div class="kpi"><small><i data-lucide="video"></i> –í—ñ–¥–µ–æ —É –ø–ª–∞–Ω—ñ</small><b id="kpiVideos">‚Äî</b></div>
          <div class="kpi"><small><i data-lucide="timer"></i> –û—Ä—ñ—î–Ω—Ç–∏—Ä —á–∞—Å—É</small><b id="kpiTime">‚Äî</b></div>
          <div class="kpi"><small><i data-lucide="layers-3"></i> –°–µ—Ä—ñ—ó/—Ä—É–±—Ä–∏–∫–∏</small><b id="kpiSeries">‚Äî</b></div>
        </div>

        <!-- TAB CONTENTS -->
        <div id="tab_plan" class="tabPane"></div>
        <div id="tab_scripts" class="tabPane" style="display:none;"></div>
        <div id="tab_batch" class="tabPane" style="display:none;"></div>
        <div id="tab_dm" class="tabPane" style="display:none;"></div>
        <div id="tab_export" class="tabPane" style="display:none;"></div>
      </div>
    </section>
  </div>

  <footer>
    ¬© <span id="year"></span> Content Generator PRO.
    <span style="opacity:.6">‚Ä¢</span>
    <a class="mutedLink" href="#" id="btnHelpFooter">–ü—ñ–¥–∫–∞–∑–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</a>
  </footer>
</main>

<!-- Drawer (details) -->
<div class="drawer" id="drawer">
  <div class="sheet">
    <div class="sheetTop">
      <div>
        <b id="dTitle">–î–µ—Ç–∞–ª—ñ</b>
        <small id="dSub">‚Äî</small>
      </div>
      <div class="closeX" id="btnCloseDrawer" title="–ó–∞–∫—Ä–∏—Ç–∏"><i data-lucide="x"></i></div>
    </div>

    <div class="twoCols">
      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="zap"></i> –ì–∞—á–∫–∏ (3 –≤–∞—Ä—ñ–∞–Ω—Ç–∏)</b>
          <button class="btn secondary" id="btnCopyHooks" type="button"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div class="mono" id="dHooks">‚Äî</div>
      </div>

      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="file-text"></i> –°–∫—Ä–∏–ø—Ç (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)</b>
          <button class="btn secondary" id="btnCopyScript" type="button"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div class="mono" id="dScript">‚Äî</div>
      </div>

      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="type"></i> –¢–µ–∫—Å—Ç –Ω–∞ –µ–∫—Ä–∞–Ω—ñ</b>
          <button class="btn secondary" id="btnCopyOnscreen" type="button"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div class="mono" id="dOnscreen">‚Äî</div>
      </div>

      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="camera"></i> –°–ø–∏—Å–æ–∫ –∫–∞–¥—Ä—ñ–≤ (—â–æ –∑–Ω—è—Ç–∏)</b>
          <button class="btn secondary" id="btnCopyShots" type="button"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div class="mono" id="dShots">‚Äî</div>
      </div>

      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="align-left"></i> –û–ø–∏—Å (caption) + CTA</b>
          <button class="btn secondary" id="btnCopyCaption" type="button"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div class="mono" id="dCaption">‚Äî</div>
      </div>

      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="hash"></i> –•–µ—à—Ç–µ–≥–∏</b>
          <button class="btn secondary" id="btnCopyHashtags" type="button"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div class="mono" id="dHashtags">‚Äî</div>
      </div>

      <div class="block" style="grid-column:1/-1">
        <div class="blockHead">
          <b><i data-lucide="message-square"></i> DM-—Å–∫—Ä–∏–ø—Ç (–≤—ñ–¥–ø–æ–≤—ñ–¥—å –∫–ª—ñ—î–Ω—Ç—É)</b>
          <button class="btn secondary" id="btnCopyDM" type="button"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div class="mono" id="dDM">‚Äî</div>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast">–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ ‚úÖ</div>

<script>
"use strict";

/* ===============================
   STORAGE KEYS
================================ */
const STATE_KEY = "sa_content_generator_pro_state_v1";
const PROJECTS_KEY = "sa_content_generator_pro_projects_v1";

/* ===============================
   DOM
================================ */
const yearEl = document.getElementById("year");
yearEl.textContent = new Date().getFullYear();

const statePill = document.getElementById("statePill");

const btnGenerate = document.getElementById("btnGenerate");
const btnGenerate2 = document.getElementById("btnGenerate2");
const btnRegenerate = document.getElementById("btnRegenerate");
const btnReset = document.getElementById("btnReset");

const btnCopyAll = document.getElementById("btnCopyAll");
const btnCopyTab = document.getElementById("btnCopyTab");

const btnDownloadTxt = document.getElementById("btnDownloadTxt");
const btnDownloadCsv = document.getElementById("btnDownloadCsv");
const btnDownloadJson = document.getElementById("btnDownloadJson");

const btnQuickStart = document.getElementById("btnQuickStart");
const btnHelpFooter = document.getElementById("btnHelpFooter");

const outTitle = document.getElementById("outTitle");
const outSubtitle = document.getElementById("outSubtitle");
const kpis = document.getElementById("kpis");
const kpiVideos = document.getElementById("kpiVideos");
const kpiTime = document.getElementById("kpiTime");
const kpiSeries = document.getElementById("kpiSeries");

const tabPlan = document.getElementById("tab_plan");
const tabScripts = document.getElementById("tab_scripts");
const tabBatch = document.getElementById("tab_batch");
const tabDM = document.getElementById("tab_dm");
const tabExport = document.getElementById("tab_export");

const tabs = document.getElementById("tabs");

// Settings inputs
const projectName = document.getElementById("projectName");
const projectSelect = document.getElementById("projectSelect");
const btnSaveProject = document.getElementById("btnSaveProject");
const btnLoadProject = document.getElementById("btnLoadProject");
const btnDeleteProject = document.getElementById("btnDeleteProject");

const platformEl = document.getElementById("platform");
const languageEl = document.getElementById("language");
const productEl = document.getElementById("product");
const ctaWordEl = document.getElementById("ctaWord");
const regionEl = document.getElementById("region");
const goalEl = document.getElementById("goal");

const audienceEl = document.getElementById("audience");
const priceLevelEl = document.getElementById("priceLevel");
const offerEl = document.getElementById("offer");
const proofEl = document.getElementById("proof");
const objectionEl = document.getElementById("objection");

const planDaysEl = document.getElementById("planDays");
const paceEl = document.getElementById("pace");
const lengthSecEl = document.getElementById("lengthSec");
const timeSlotEl = document.getElementById("timeSlot");
const styleEl = document.getElementById("style");
const productsListEl = document.getElementById("productsList");

const faceEl = document.getElementById("face");
const voiceEl = document.getElementById("voice");
const toolsEl = document.getElementById("tools");

const seedEl = document.getElementById("seed");
const focusSeriesEl = document.getElementById("focusSeries");
const hashtagsModeEl = document.getElementById("hashtagsMode");
const ctaModeEl = document.getElementById("ctaMode");

// Drawer
const drawer = document.getElementById("drawer");
const btnCloseDrawer = document.getElementById("btnCloseDrawer");
const dTitle = document.getElementById("dTitle");
const dSub = document.getElementById("dSub");
const dHooks = document.getElementById("dHooks");
const dScript = document.getElementById("dScript");
const dOnscreen = document.getElementById("dOnscreen");
const dShots = document.getElementById("dShots");
const dCaption = document.getElementById("dCaption");
const dHashtags = document.getElementById("dHashtags");
const dDM = document.getElementById("dDM");

const btnCopyHooks = document.getElementById("btnCopyHooks");
const btnCopyScript = document.getElementById("btnCopyScript");
const btnCopyOnscreen = document.getElementById("btnCopyOnscreen");
const btnCopyShots = document.getElementById("btnCopyShots");
const btnCopyCaption = document.getElementById("btnCopyCaption");
const btnCopyHashtags = document.getElementById("btnCopyHashtags");
const btnCopyDM = document.getElementById("btnCopyDM");

const toast = document.getElementById("toast");

/* ===============================
   UI: Collapsible sections
================================ */
document.querySelectorAll(".section .secTitle").forEach(t=>{
  t.addEventListener("click", ()=>{
    const sec = t.closest(".section");
    sec.classList.toggle("open");
  });
});

/* ===============================
   Utilities
================================ */
function showToast(msg){
  toast.textContent = msg || "–ì–æ—Ç–æ–≤–æ ‚úÖ";
  toast.style.display = "block";
  clearTimeout(showToast._t);
  showToast._t = setTimeout(()=> toast.style.display="none", 1200);
}

async function copyToClipboard(text){
  try{
    await navigator.clipboard.writeText(String(text || "").trim());
    showToast("–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ ‚úÖ");
  }catch(e){
    alert("–ù–µ –≤–¥–∞–ª–æ—Å—è —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏. –°–∫–æ–ø—ñ—é–π –≤—Ä—É—á–Ω—É üôÇ");
  }
}

function safeStr(v, fallback){
  const s = String(v ?? "").trim();
  return s ? s : fallback;
}

function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

function slugify(s){
  return String(s || "")
    .toLowerCase()
    .replace(/[‚Äô'"]/g,"")
    .replace(/[^a-z–∞-—è—ë—ñ—ó—î0-9]+/gi,"")
    .slice(0, 24);
}

/* ===============================
   Seeded random (deterministic)
================================ */
function xmur3(str){
  for(var i=0, h=1779033703 ^ str.length; i<str.length; i++){
    h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
    h = h << 13 | h >>> 19;
  }
  return function(){
    h = Math.imul(h ^ (h >>> 16), 2246822507);
    h = Math.imul(h ^ (h >>> 13), 3266489909);
    return (h ^= h >>> 16) >>> 0;
  };
}
function sfc32(a,b,c,d){
  return function(){
    a >>>= 0; b >>>= 0; c >>>= 0; d >>>= 0;
    var t = (a + b) | 0;
    a = b ^ b >>> 9;
    b = c + (c << 3) | 0;
    c = (c << 21 | c >>> 11);
    d = d + 1 | 0;
    t = t + d | 0;
    c = c + t | 0;
    return (t >>> 0) / 4294967296;
  };
}
function makeRand(seed){
  const s = String(seed || (Date.now()+"_"+Math.random()));
  const seedFn = xmur3(s);
  const rand = sfc32(seedFn(), seedFn(), seedFn(), seedFn());
  rand._seed = s;
  return rand;
}
function pick(rand, arr, i){
  if(!arr || !arr.length) return "";
  const idx = (typeof i === "number") ? (i % arr.length) : Math.floor(rand() * arr.length);
  return arr[idx];
}

/* ===============================
   Multilanguage helpers
================================ */
function t(lang, uk, ru){
  return lang === "ru" ? ru : uk;
}

/* ===============================
   Config
================================ */
function getConfig(){
  const lang = languageEl.value;

  const productsList = String(productsListEl.value || "")
    .split("\n")
    .map(s=>s.trim())
    .filter(Boolean);

  const cfg = {
    projectName: safeStr(projectName.value, ""),
    platform: platformEl.value,
    lang,
    product: safeStr(productEl.value, t(lang, "3D –ø–∞–Ω–µ–ª—ñ / –¥–µ–∫–æ—Ä-–ø–∞–Ω–µ–ª—ñ", "3D –ø–∞–Ω–µ–ª–∏ / –¥–µ–∫–æ—Ä-–ø–∞–Ω–µ–ª–∏")),
    ctaWord: safeStr(ctaWordEl.value, t(lang, "–•–û–ß–£", "–•–û–ß–£")).toUpperCase(),
    region: safeStr(regionEl.value, ""),
    goal: goalEl.value,

    audience: audienceEl.value,
    priceLevel: priceLevelEl.value,
    offer: safeStr(offerEl.value, ""),
    proof: proofEl.value,
    objection: objectionEl.value,

    planDays: parseInt(planDaysEl.value, 10),
    pace: paceEl.value,
    lengthSec: parseInt(lengthSecEl.value, 10),
    timeSlot: timeSlotEl.value,
    style: styleEl.value,
    productsList,

    face: faceEl.value,
    voice: voiceEl.value,
    tools: toolsEl.value,

    seed: safeStr(seedEl.value, ""),
    focusSeries: focusSeriesEl.value,
    hashtagsMode: hashtagsModeEl.value,
    ctaMode: ctaModeEl.value,
  };
  return cfg;
}

function setConfig(cfg){
  if(!cfg) return;

  projectName.value = cfg.projectName || "";
  platformEl.value = cfg.platform || "TikTok";
  languageEl.value = cfg.lang || "uk";
  productEl.value = cfg.product || "";
  ctaWordEl.value = cfg.ctaWord || "";
  regionEl.value = cfg.region || "";
  goalEl.value = cfg.goal || "messages";

  audienceEl.value = cfg.audience || "homeowners";
  priceLevelEl.value = cfg.priceLevel || "value";
  offerEl.value = cfg.offer || "";
  proofEl.value = cfg.proof || "basic";
  objectionEl.value = cfg.objection || "price";

  planDaysEl.value = String(cfg.planDays || 14);
  paceEl.value = cfg.pace || "daily";
  lengthSecEl.value = String(cfg.lengthSec || 20);
  timeSlotEl.value = cfg.timeSlot || "evening";
  styleEl.value = cfg.style || "friendly";
  productsListEl.value = (cfg.productsList || []).join("\n");

  faceEl.value = cfg.face || "no";
  voiceEl.value = cfg.voice || "no";
  toolsEl.value = cfg.tools || "phone";

  seedEl.value = cfg.seed || "";
  focusSeriesEl.value = cfg.focusSeries || "balanced";
  hashtagsModeEl.value = cfg.hashtagsMode || "smart";
  ctaModeEl.value = cfg.ctaMode || "soft";
}

/* ===============================
   Offer defaults
================================ */
function defaultOffer(cfg){
  const lang = cfg.lang;
  const p = cfg.product;
  const region = cfg.region ? (" ("+cfg.region+")") : "";
  const baseUk = `–ü—ñ–¥–±–µ—Ä—É ${p} –ø—ñ–¥ –≤–∞—à—É –ø–ª–æ—â—É, —Å–∫–∏–Ω—É –≤—ñ–¥–µ–æ/—Ñ–æ—Ç–æ –≤–∂–∏–≤—É, –ø–æ—Ä–∞—Ö—É—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å —ñ –¥–æ—Å—Ç–∞–≤–∫—É${region}.`;
  const baseRu = `–ü–æ–¥–±–µ—Ä—É ${p} –ø–æ–¥ –≤–∞—à—É –ø–ª–æ—â–∞–¥—å, –ø—Ä–∏—à–ª—é –≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ –≤–∂–∏–≤—É—é, –ø–æ—Å—á–∏—Ç–∞—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –¥–æ—Å—Ç–∞–≤–∫—É${region}.`;
  return t(lang, baseUk, baseRu);
}

/* ===============================
   Series library
================================ */
function buildSeriesLibrary(cfg, rand){
  const lang = cfg.lang;
  const p = cfg.product;

  const series = [
    {
      id:"A_before_after",
      name: t(lang, "–î–æ/–ü—ñ—Å–ª—è (—Ä–µ–∑—É–ª—å—Ç–∞—Ç)", "–î–æ/–ü–æ—Å–ª–µ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç)"),
      type:"result",
      topicIdeas: [
        t(lang,"–ö—É—Ç –∫—ñ–º–Ω–∞—Ç–∏: –±—É–ª–æ ‚Üí —Å—Ç–∞–ª–æ","–£–≥–æ–ª –∫–æ–º–Ω–∞—Ç—ã: –±—ã–ª–æ ‚Üí —Å—Ç–∞–ª–æ"),
        t(lang,"1 —Å—Ç—ñ–Ω–∞/—Ñ—Ä–∞–≥–º–µ–Ω—Ç: –±—É–ª–æ ‚Üí —Å—Ç–∞–ª–æ","1 —Å—Ç–µ–Ω–∞/—Ñ—Ä–∞–≥–º–µ–Ω—Ç: –±—ã–ª–æ ‚Üí —Å—Ç–∞–ª–æ"),
        t(lang,"–®–≤–∏–¥–∫–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞ 1 –¥–µ–Ω—å","–ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ 1 –¥–µ–Ω—å"),
        t(lang,"–ú–∞–ª–µ–Ω—å–∫–∞ –∑–æ–Ω–∞ –¥–∞—î –≤–∞—É-–µ—Ñ–µ–∫—Ç","–ú–∞–ª–µ–Ω—å–∫–∞—è –∑–æ–Ω–∞ –¥–∞—ë—Ç –≤–∞—É-—ç—Ñ—Ñ–µ–∫—Ç"),
        t(lang,"–†–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –ø–∏–ª—É —ñ —Ä–µ–º–æ–Ω—Ç—É","–†–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –ø—ã–ª–∏ –∏ —Ä–µ–º–æ–Ω—Ç–∞"),
      ]
    },
    {
      id:"B_live_texture",
      name: t(lang,"–í–∂–∏–≤—É / —Ñ–∞–∫—Ç—É—Ä–∞ (–¥–æ–≤—ñ—Ä–∞)","–í–∂–∏–≤—É—é / —Ñ–∞–∫—Ç—É—Ä–∞ (–¥–æ–≤–µ—Ä–∏–µ)"),
      type:"trust",
      topicIdeas: [
        t(lang,"–ö—Ä—É–ø–Ω–∏–π –ø–ª–∞–Ω: —Ç–µ–∫—Å—Ç—É—Ä–∞ —ñ —Ä–µ–ª—å—î—Ñ","–ö—Ä—É–ø–Ω—ã–π –ø–ª–∞–Ω: —Ç–µ–∫—Å—Ç—É—Ä–∞ –∏ —Ä–µ–ª—å–µ—Ñ"),
        t(lang,"–ü—ñ–¥ —Å–≤—ñ—Ç–ª–æ–º: —è–∫ –≥—Ä–∞—î –ø–æ–≤–µ—Ä—Ö–Ω—è","–ü–æ–¥ —Å–≤–µ—Ç–æ–º: –∫–∞–∫ –∏–≥—Ä–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å"),
        t(lang,"–ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ 2 –º: —è–∫ –≤–∏–≥–ª—è–¥–∞—î –≤ –∫—ñ–º–Ω–∞—Ç—ñ","–° —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è 2 –º: –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –∫–æ–º–Ω–∞—Ç–µ"),
        t(lang,"–¢–æ–≤—â–∏–Ω–∞/—Å—Ç–∏–∫/—Ä—ñ–≤–Ω—ñ—Å—Ç—å","–¢–æ–ª—â–∏–Ω–∞/—Å—Ç—ã–∫/—Ä–æ–≤–Ω–æ—Å—Ç—å"),
        t(lang,"–©–æ –ø—Ä–∏—ó–¥–µ: —É–ø–∞–∫–æ–≤–∫–∞/–∫–æ–º–ø–ª–µ–∫—Ç","–ß—Ç–æ –ø—Ä–∏–µ–¥–µ—Ç: —É–ø–∞–∫–æ–≤–∫–∞/–∫–æ–º–ø–ª–µ–∫—Ç"),
      ]
    },
    {
      id:"C_faq",
      name: t(lang,"FAQ / –∑–∞–ø–µ—Ä–µ—á–µ–Ω–Ω—è (–ø—Ä–æ–¥–∞–∂)","FAQ / –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è (–ø—Ä–æ–¥–∞–∂–∞)"),
      type:"faq",
      topicIdeas: [
        t(lang,"–ß–∏ –ø—ñ–¥—ñ–π–¥–µ –¥–ª—è –∫—É—Ö–Ω—ñ/–≤–∞–Ω–Ω–∏?","–ü–æ–¥–æ–π–¥–µ—Ç –¥–ª—è –∫—É—Ö–Ω–∏/–≤–∞–Ω–Ω—ã?"),
        t(lang,"–ß–∏ –º–æ–∂–Ω–∞ –Ω–∞ –Ω–µ—Ä—ñ–≤–Ω—ñ —Å—Ç—ñ–Ω–∏?","–ú–æ–∂–Ω–æ –Ω–∞ –Ω–µ—Ä–æ–≤–Ω—ã–µ —Å—Ç–µ–Ω—ã?"),
        t(lang,"–°–∫—ñ–ª—å–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞ 5 –º¬≤?","–°–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ –Ω–∞ 5 –º¬≤?"),
        t(lang,"–ú–æ–Ω—Ç–∞–∂ —Å–∫–ª–∞–¥–Ω–∏–π? 3 –∫—Ä–æ–∫–∏","–ú–æ–Ω—Ç–∞–∂ —Å–ª–æ–∂–Ω—ã–π? 3 —à–∞–≥–∞"),
        t(lang,"–î–æ—Å—Ç–∞–≤–∫–∞/–æ–ø–ª–∞—Ç–∞/—Ç–µ—Ä–º—ñ–Ω–∏","–î–æ—Å—Ç–∞–≤–∫–∞/–æ–ø–ª–∞—Ç–∞/—Å—Ä–æ–∫–∏"),
      ]
    },
    {
      id:"D_mistakes",
      name: t(lang,"–ü–æ–º–∏–ª–∫–∏ (–Ω–∞–≤—á–∞–Ω–Ω—è)","–û—à–∏–±–∫–∏ (–æ–±—É—á–µ–Ω–∏–µ)"),
      type:"learn",
      topicIdeas: [
        t(lang,"–¢–û–ü-3 –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –º–æ–Ω—Ç–∞–∂—ñ","–¢–û–ü-3 –æ—à–∏–±–∫–∏ –ø—Ä–∏ –º–æ–Ω—Ç–∞–∂–µ"),
        t(lang,"–ß–æ–º—É ‚Äú–≤—ñ–¥–ø–∞–¥–∞—î‚Äù (—ñ —è–∫ –∑—Ä–æ–±–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)","–ü–æ—á–µ–º—É ‚Äú–æ—Ç–ø–∞–¥–∞–µ—Ç‚Äù (–∏ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)"),
        t(lang,"–Ø–∫–∏–π –∫–ª–µ–π/–æ—Å–Ω–æ–≤–∞ –ø–æ—Ç—Ä—ñ–±–Ω—ñ","–ö–∞–∫–æ–π –∫–ª–µ–π/–æ—Å–Ω–æ–≤–∞ –Ω—É–∂–Ω—ã"),
        t(lang,"–Ø–∫ –Ω–µ –∑—ñ–ø—Å—É–≤–∞—Ç–∏ –≤–∏–≥–ª—è–¥ —Å—Ç–∏–∫–∞–º–∏","–ö–∞–∫ –Ω–µ –∏—Å–ø–æ—Ä—Ç–∏—Ç—å –≤–∏–¥ —Å—Ç—ã–∫–∞–º–∏"),
        t(lang,"–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–æ–≤–µ—Ä—Ö–Ω—ñ –∑–∞ 2 —Ö–≤","–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∑–∞ 2 –º–∏–Ω"),
      ]
    },
    {
      id:"E_price_calc",
      name: t(lang,"–¶—ñ–Ω–∞ / –ø—Ä–æ—Ä–∞—Ö—É–Ω–æ–∫ (–ø—Ä—è–º—ñ –ø—Ä–æ–¥–∞–∂—ñ)","–¶–µ–Ω–∞ / —Ä–∞—Å—á—ë—Ç (–ø—Ä—è–º—ã–µ –ø—Ä–æ–¥–∞–∂–∏)"),
      type:"sales",
      topicIdeas: [
        t(lang,"–°–∫—ñ–ª—å–∫–∏ –∫–æ—à—Ç—É—î –æ–Ω–æ–≤–∏—Ç–∏ 5 –º¬≤","–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –æ–±–Ω–æ–≤–∏—Ç—å 5 –º¬≤"),
        t(lang,"–ë—é–¥–∂–µ—Ç–Ω–∏–π vs –¥–æ—Ä–æ–∂—á–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç (–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è)","–ë—é–¥–∂–µ—Ç–Ω—ã–π vs –¥–æ—Ä–æ–∂–µ (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ)"),
        t(lang,"–ù–∞ —â–æ –≤–ø–ª–∏–≤–∞—î —Ü—ñ–Ω–∞ (–º–∞—Ç–µ—Ä—ñ–∞–ª/—Ñ–∞–∫—Ç—É—Ä–∞)","–ù–∞ —á—Ç–æ –≤–ª–∏—è–µ—Ç —Ü–µ–Ω–∞ (–º–∞—Ç–µ—Ä–∏–∞–ª/—Ñ–∞–∫—Ç—É—Ä–∞)"),
        t(lang,"–Ø–∫ –Ω–µ –ø–µ—Ä–µ–ø–ª–∞—Ç–∏—Ç–∏: 2 –ø–æ—Ä–∞–¥–∏","–ö–∞–∫ –Ω–µ –ø–µ—Ä–µ–ø–ª–∞—Ç–∏—Ç—å: 2 —Å–æ–≤–µ—Ç–∞"),
        t(lang,"–ì–æ—Ç–æ–≤–∏–π –ø—ñ–¥–±—ñ—Ä –ø—ñ–¥ –≤–∞—à –±—é–¥–∂–µ—Ç","–ì–æ—Ç–æ–≤—ã–π –ø–æ–¥–±–æ—Ä –ø–æ–¥ –≤–∞—à –±—é–¥–∂–µ—Ç"),
      ]
    },
    {
      id:"F_story",
      name: t(lang,"–ú—ñ–Ω—ñ-—ñ—Å—Ç–æ—Ä—ñ—è / –∫–µ–π—Å (—Å–æ—Ü–¥–æ–∫–∞–∑)","–ú–∏–Ω–∏-–∏—Å—Ç–æ—Ä–∏—è / –∫–µ–π—Å (—Å–æ—Ü–¥–æ–∫–∞–∑)"),
      type:"trust",
      topicIdeas: [
        t(lang,"–ö–ª—ñ—î–Ω—Ç —Ö–æ—Ç—ñ–≤ ‚Äò–¥–æ—Ä–æ–≥–æ‚Äô –±–µ–∑ —Ä–µ–º–æ–Ω—Ç—É ‚Äî —â–æ –ø—ñ–¥—ñ–±—Ä–∞–ª–∏","–ö–ª–∏–µ–Ω—Ç —Ö–æ—Ç–µ–ª ‚Äò–¥–æ—Ä–æ–≥–æ‚Äô –±–µ–∑ —Ä–µ–º–æ–Ω—Ç–∞ ‚Äî —á—Ç–æ –ø–æ–¥–æ–±—Ä–∞–ª–∏"),
        t(lang,"–Ø–∫ –∑–º—ñ–Ω–∏–ª–∏ –∫—ñ–º–Ω–∞—Ç—É –∑–∞ 1 –≤–µ—á—ñ—Ä","–ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–∏ –∫–æ–º–Ω–∞—Ç—É –∑–∞ 1 –≤–µ—á–µ—Ä"),
        t(lang,"–î–æ/–ø—ñ—Å–ª—è + –ø–∏—Ç–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞ + —Ä—ñ—à–µ–Ω–Ω—è","–î–æ/–ø–æ—Å–ª–µ + –≤–æ–ø—Ä–æ—Å –∫–ª–∏–µ–Ω—Ç–∞ + —Ä–µ—à–µ–Ω–∏–µ"),
        t(lang,"–ö–µ–π—Å: –º–∞–ª–µ–Ω—å–∫–∞ –ø–ª–æ—â–∞ ‚Äî —Å–∏–ª—å–Ω–∏–π –µ—Ñ–µ–∫—Ç","–ö–µ–π—Å: –º–∞–ª–µ–Ω—å–∫–∞—è –ø–ª–æ—â–∞–¥—å ‚Äî —Å–∏–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç"),
        t(lang,"–©–æ –ª—é–¥–∏ –ø–∏—Ç–∞—é—Ç—å –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ (—ñ —á–æ–º—É)","–ß—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç —á–∞—â–µ –≤—Å–µ–≥–æ (–∏ –ø–æ—á–µ–º—É)"),
      ]
    }
  ];

  // Apply focus preference by weighting
  const focus = cfg.focusSeries;
  let pool = [];

  function addMany(id, times){
    const s = series.find(x=>x.id===id);
    if(!s) return;
    for(let i=0;i<times;i++) pool.push(s);
  }

  if(focus === "sales"){
    addMany("A_before_after", 4);
    addMany("E_price_calc", 4);
    addMany("C_faq", 3);
    addMany("B_live_texture", 2);
    addMany("D_mistakes", 1);
    addMany("F_story", 2);
  }else if(focus === "trust"){
    addMany("B_live_texture", 4);
    addMany("F_story", 4);
    addMany("A_before_after", 3);
    addMany("C_faq", 2);
    addMany("D_mistakes", 2);
    addMany("E_price_calc", 1);
  }else if(focus === "faq"){
    addMany("C_faq", 5);
    addMany("D_mistakes", 3);
    addMany("B_live_texture", 2);
    addMany("A_before_after", 2);
    addMany("E_price_calc", 2);
    addMany("F_story", 1);
  }else{
    // balanced
    addMany("A_before_after", 3);
    addMany("B_live_texture", 3);
    addMany("C_faq", 3);
    addMany("D_mistakes", 2);
    addMany("E_price_calc", 2);
    addMany("F_story", 2);
  }

  return {series, pool};
}

/* ===============================
   Hook generator
================================ */
function buildHooks(cfg, seriesName, topic, rand){
  const lang = cfg.lang;
  const p = cfg.product;

  const patternsUk = [
    `–û–Ω–æ–≤–∏ –ø—Ä–æ—Å—Ç—ñ—Ä –∑–∞ 1 –¥–µ–Ω—å: ${topic.toLowerCase()}‚Ä¶`,
    `90% —Ä–æ–±–ª—è—Ç—å –ø–æ–º–∏–ª–∫—É: ${topic.toLowerCase()} ‚Äî –ø–æ–∫–∞–∂—É —è–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ`,
    `–Ø–∫ –≤–∏–≥–ª—è–¥–∞—î ${p} –≤–∂–∏–≤—É? –î–∏–≤–∏—Å—å –±–ª–∏–∑—å–∫–æ üëá`,
    `–î–æ/–ø—ñ—Å–ª—è, —è–∫–µ —Ä–µ–∞–ª—å–Ω–æ –∑–º—ñ–Ω—é—î –∫—ñ–º–Ω–∞—Ç—É: ${topic.toLowerCase()}`,
    `–ü–∏—Ç–∞–Ω–Ω—è ‚Ññ1 –≤—ñ–¥ –ª—é–¥–µ–π: ‚Äú${topic.replace(/\?$/,"")}?‚Äù ‚Äî –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é`,
    `–°–∫—ñ–ª—å–∫–∏ —Ü–µ –∫–æ—à—Ç—É—î? ${topic.replace(/\?$/,"")} ‚Äî –ø–æ–∫–∞–∂—É –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ`,
    `–®–≤–∏–¥–∫–∏–π –ª–∞–π—Ñ—Ö–∞–∫: ${topic.toLowerCase()} –∑–∞ 15 —Å–µ–∫—É–Ω–¥`,
    `–†—ñ—à–µ–Ω–Ω—è –±–µ–∑ –ø–∏–ª—É —ñ —Ä–µ–º–æ–Ω—Ç—É: ${topic.toLowerCase()}`
  ];

  const patternsRu = [
    `–û–±–Ω–æ–≤–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∑–∞ 1 –¥–µ–Ω—å: ${topic.toLowerCase()}‚Ä¶`,
    `90% –¥–µ–ª–∞—é—Ç –æ—à–∏–±–∫—É: ${topic.toLowerCase()} ‚Äî –ø–æ–∫–∞–∂—É –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ`,
    `–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç ${p} –≤–∂–∏–≤—É—é? –°–º–æ—Ç—Ä–∏ –±–ª–∏–∂–µ üëá`,
    `–î–æ/–ø–æ—Å–ª–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ä–µ–∞–ª—å–Ω–æ –º–µ–Ω—è–µ—Ç –∫–æ–º–Ω–∞—Ç—É: ${topic.toLowerCase()}`,
    `–í–æ–ø—Ä–æ—Å ‚Ññ1: ‚Äú${topic.replace(/\?$/,"")}?‚Äù ‚Äî –æ—Ç–≤–µ—á–∞—é`,
    `–°–∫–æ–ª—å–∫–æ —ç—Ç–æ —Å—Ç–æ–∏—Ç? ${topic.replace(/\?$/,"")} ‚Äî –ø–æ–∫–∞–∂—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ`,
    `–ë—ã—Å—Ç—Ä—ã–π –ª–∞–π—Ñ—Ö–∞–∫: ${topic.toLowerCase()} –∑–∞ 15 —Å–µ–∫—É–Ω–¥`,
    `–†–µ—à–µ–Ω–∏–µ –±–µ–∑ –ø—ã–ª–∏ –∏ —Ä–µ–º–æ–Ω—Ç–∞: ${topic.toLowerCase()}`
  ];

  const arr = (lang === "ru") ? patternsRu : patternsUk;

  // Pick 3 distinct-ish
  const h1 = pick(rand, arr, 0 + Math.floor(rand()*arr.length));
  const h2 = pick(rand, arr, 3 + Math.floor(rand()*arr.length));
  const h3 = pick(rand, arr, 6 + Math.floor(rand()*arr.length));

  return [h1, h2, h3].map(s=>s.replace(/\s+/g," ").trim());
}

/* ===============================
   On-screen text generator
================================ */
function buildOnscreen(cfg, topic){
  const lang = cfg.lang;
  const cta = cfg.ctaWord;
  const soft = cfg.ctaMode === "soft";
  const bonus = cfg.ctaMode === "bonus";

  const line1 = t(lang, "–®–≤–∏–¥–∫–æ ‚Ä¢ –ü—Ä–æ—Å—Ç–æ ‚Ä¢ –ö—Ä–∞—Å–∏–≤–æ", "–ë—ã—Å—Ç—Ä–æ ‚Ä¢ –ü—Ä–æ—Å—Ç–æ ‚Ä¢ –ö—Ä–∞—Å–∏–≤–æ");
  const line2 = topic.replace(/\s+/g," ").trim();

  let line3 = "";
  if(bonus){
    line3 = t(lang, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî –ø—ñ–¥–±—ñ—Ä + –ø—Ä–æ—Ä–∞—Ö—É–Ω–æ–∫`, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî –ø–æ–¥–±–æ—Ä + —Ä–∞—Å—á—ë—Ç`);
  }else if(soft){
    line3 = t(lang, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî –ø—ñ–¥–∫–∞–∂—É –≤–∞—Ä—ñ–∞–Ω—Ç`, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî –ø–æ–¥—Å–∫–∞–∂—É –≤–∞—Ä–∏–∞–Ω—Ç`);
  }else{
    line3 = t(lang, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî —Ü—ñ–Ω–∞/–ø—Ä–æ—Ä–∞—Ö—É–Ω–æ–∫`, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî —Ü–µ–Ω–∞/—Ä–∞—Å—á—ë—Ç`);
  }

  return [line1, line2, line3];
}

/* ===============================
   Shots list generator (adapt to no-face/no-voice)
================================ */
function buildShots(cfg, seriesType, topic){
  const lang = cfg.lang;
  const noFace = cfg.face === "no";
  const noVoice = cfg.voice === "no";

  const base = [];
  const add = (uk, ru) => base.push(t(lang, uk, ru));

  add("–ö–∞–¥—Ä 1: –Ω–∞–π–∫—Ä–∞—â–∏–π –∫—Ä—É–ø–Ω–∏–π –ø–ª–∞–Ω (—Ñ–∞–∫—Ç—É—Ä–∞/–¥–µ—Ç–∞–ª—å)", "–ö–∞–¥—Ä 1: –ª—É—á—à–∏–π –∫—Ä—É–ø–Ω—ã–π –ø–ª–∞–Ω (—Ñ–∞–∫—Ç—É—Ä–∞/–¥–µ—Ç–∞–ª—å)");
  add("–ö–∞–¥—Ä 2: –∑–∞–≥–∞–ª—å–Ω–∏–π –≤–∏–¥ (–∫—ñ–º–Ω–∞—Ç–∞/—Å—Ç—ñ–Ω–∞/–ø—ñ–¥–ª–æ–≥–∞) ‚Äî 1‚Äì2 —Å–µ–∫", "–ö–∞–¥—Ä 2: –æ–±—â–∏–π –≤–∏–¥ (–∫–æ–º–Ω–∞—Ç–∞/—Å—Ç–µ–Ω–∞/–ø–æ–ª) ‚Äî 1‚Äì2 —Å–µ–∫");

  if(seriesType === "result"){
    add("–ö–∞–¥—Ä 3: ‚Äú–î–æ‚Äù (1 —Å–µ–∫)", "–ö–∞–¥—Ä 3: ‚Äú–î–æ‚Äù (1 —Å–µ–∫)");
    add("–ö–∞–¥—Ä 4: ‚Äú–ü—ñ—Å–ª—è‚Äù (2 —Å–µ–∫) ‚Äî –ø–æ–≤—ñ–ª—å–Ω–∏–π –ø–∞–Ω", "–ö–∞–¥—Ä 4: ‚Äú–ü–æ—Å–ª–µ‚Äù (2 —Å–µ–∫) ‚Äî –º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–∞–Ω");
    add("–ö–∞–¥—Ä 5: –¥–µ—Ç–∞–ª—å/—Å—Ç–∏–∫/–∫—É—Ç –ø—ñ–¥ —Å–≤—ñ—Ç–ª–æ–º", "–ö–∞–¥—Ä 5: –¥–µ—Ç–∞–ª—å/—Å—Ç—ã–∫/—É–≥–æ–ª –ø–æ–¥ —Å–≤–µ—Ç–æ–º");
  }else if(seriesType === "trust"){
    add("–ö–∞–¥—Ä 3: —Ä—É–∫–æ—é –ø–æ –ø–æ–≤–µ—Ä—Ö–Ω—ñ (—Ä–µ–ª—å—î—Ñ)", "–ö–∞–¥—Ä 3: —Ä—É–∫–æ–π –ø–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (—Ä–µ–ª—å–µ—Ñ)");
    add("–ö–∞–¥—Ä 4: –ø—ñ–¥ –∫—É—Ç–æ–º —Å–≤—ñ—Ç–ª–∞ (–≤–∏–¥–Ω–æ —Ç–µ–∫—Å—Ç—É—Ä—É)", "–ö–∞–¥—Ä 4: –ø–æ–¥ —É–≥–ª–æ–º —Å–≤–µ—Ç–∞ (–≤–∏–¥–Ω–æ —Ç–µ–∫—Å—Ç—É—Ä—É)");
    add("–ö–∞–¥—Ä 5: –∑ –≤—ñ–¥—Å—Ç–∞–Ω—ñ 2 –º (—è–∫ –≤ –∫—ñ–º–Ω–∞—Ç—ñ)", "–ö–∞–¥—Ä 5: —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è 2 –º (–∫–∞–∫ –≤ –∫–æ–º–Ω–∞—Ç–µ)");
  }else if(seriesType === "faq"){
    add("–ö–∞–¥—Ä 3: —Ç–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è –Ω–∞ –µ–∫—Ä–∞–Ω—ñ (1 —Å–µ–∫)", "–ö–∞–¥—Ä 3: —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ (1 —Å–µ–∫)");
    add("–ö–∞–¥—Ä 4: –ø–æ–∫–∞–∑—É—î—à –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–∑—É–∞–ª—å–Ω–æ (–∫–ª–µ–π/–º–æ–Ω—Ç–∞–∂/–ø—Ä–∏–∫–ª–∞–¥)", "–ö–∞–¥—Ä 4: –ø–æ–∫–∞–∑—ã–≤–∞–µ—à—å –æ—Ç–≤–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ (–∫–ª–µ–π/–º–æ–Ω—Ç–∞–∂/–ø—Ä–∏–º–µ—Ä)");
    add("–ö–∞–¥—Ä 5: —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç/–¥–µ—Ç–∞–ª—å", "–ö–∞–¥—Ä 5: —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç/–¥–µ—Ç–∞–ª—å");
  }else if(seriesType === "learn"){
    add("–ö–∞–¥—Ä 3: ‚Äú–ø–æ–º–∏–ª–∫–∞‚Äù (–ø–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥)", "–ö–∞–¥—Ä 3: ‚Äú–æ—à–∏–±–∫–∞‚Äù (–ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä)");
    add("–ö–∞–¥—Ä 4: ‚Äú—è–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ‚Äù (2 –∫—Ä–æ–∫–∏)", "–ö–∞–¥—Ä 4: ‚Äú–∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ‚Äù (2 —à–∞–≥–∞)");
    add("–ö–∞–¥—Ä 5: –∫–æ—Ä–æ—Ç–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç", "–ö–∞–¥—Ä 5: –∫–æ—Ä–æ—Ç–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç");
  }else if(seriesType === "sales"){
    add("–ö–∞–¥—Ä 3: –ø–ª–æ—â–∞/—Ä—É–ª–µ—Ç–∫–∞/–≤—ñ–∑—É–∞–ª—å–Ω–æ 1‚Äì2 –º¬≤", "–ö–∞–¥—Ä 3: –ø–ª–æ—â–∞–¥—å/—Ä—É–ª–µ—Ç–∫–∞/–≤–∏–∑—É–∞–ª—å–Ω–æ 1‚Äì2 –º¬≤");
    add("–ö–∞–¥—Ä 4: ‚Äú—Ü—ñ–Ω–∞/–≤–∞—Ä—ñ–∞–Ω—Ç‚Äù (—Ç–∏—Ç—Ä + —Ç–æ–≤–∞—Ä –≤ –∫–∞–¥—Ä—ñ)", "–ö–∞–¥—Ä 4: ‚Äú—Ü–µ–Ω–∞/–≤–∞—Ä–∏–∞–Ω—Ç‚Äù (—Ç–∏—Ç—Ä + —Ç–æ–≤–∞—Ä –≤ –∫–∞–¥—Ä–µ)");
    add("–ö–∞–¥—Ä 5: —Ñ—ñ–Ω–∞–ª—å–Ω–∞ –∫—Ä–∞—Å–∏–≤–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞", "–ö–∞–¥—Ä 5: —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞");
  }else{
    add("–ö–∞–¥—Ä 3: —Å–∏—Ç—É–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç–∞ (—Ç–∏—Ç—Ä)", "–ö–∞–¥—Ä 3: —Å–∏—Ç—É–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ (—Ç–∏—Ç—Ä)");
    add("–ö–∞–¥—Ä 4: —â–æ –ø—ñ–¥—ñ–±—Ä–∞–ª–∏ (–≤—ñ–∑—É–∞–ª)", "–ö–∞–¥—Ä 4: —á—Ç–æ –ø–æ–¥–æ–±—Ä–∞–ª–∏ (–≤–∏–∑—É–∞–ª)");
    add("–ö–∞–¥—Ä 5: —Ä–µ–∑—É–ª—å—Ç–∞—Ç/–¥–æ-–ø—ñ—Å–ª—è", "–ö–∞–¥—Ä 5: —Ä–µ–∑—É–ª—å—Ç–∞—Ç/–¥–æ-–ø–æ—Å–ª–µ");
  }

  add("–ö–∞–¥—Ä 6: CTA –Ω–∞ –µ–∫—Ä–∞–Ω—ñ (1 —Å–µ–∫)", "–ö–∞–¥—Ä 6: CTA –Ω–∞ —ç–∫—Ä–∞–Ω–µ (1 —Å–µ–∫)");

  if(noFace){
    base.push(t(lang, "–§—ñ—à–∫–∞: –∑–Ω—ñ–º–∞–π —Ä—É–∫–∏ + —Ç–æ–≤–∞—Ä + —ñ–Ω—Ç–µ—Ä‚Äô—î—Ä (–±–µ–∑ –æ–±–ª–∏—á—á—è).", "–§–∏—à–∫–∞: —Å–Ω–∏–º–∞–π —Ä—É–∫–∏ + —Ç–æ–≤–∞—Ä + –∏–Ω—Ç–µ—Ä—å–µ—Ä (–±–µ–∑ –ª–∏—Ü–∞)."));
  }
  if(noVoice){
    base.push(t(lang, "–§—ñ—à–∫–∞: —Ä–æ–±–∏ —Å–∏–ª—å–Ω—ñ —Ç–∏—Ç—Ä–∏ (3 —Ä—è–¥–∫–∏) + –ø–æ–∫–∞–∑—É–π –≤—ñ–∑—É–∞–ª—å–Ω–æ.", "–§–∏—à–∫–∞: –¥–µ–ª–∞–π —Å–∏–ª—å–Ω—ã–µ —Ç–∏—Ç—Ä—ã (3 —Å—Ç—Ä–æ–∫–∏) + –ø–æ–∫–∞–∑—ã–≤–∞–π –≤–∏–∑—É–∞–ª—å–Ω–æ."));
  }
  return base;
}

/* ===============================
   Script generator
================================ */
function buildScript(cfg, seriesName, topic, hooks){
  const lang = cfg.lang;
  const p = cfg.product;
  const len = cfg.lengthSec;
  const cta = cfg.ctaWord;

  const style = cfg.style;
  const tone =
    style === "expert" ? t(lang, "–≤–ø–µ–≤–Ω–µ–Ω–æ, –∫–æ—Ä–æ—Ç–∫–æ", "—É–≤–µ—Ä–µ–Ω–Ω–æ, –∫–æ—Ä–æ—Ç–∫–æ")
    : style === "energetic" ? t(lang, "—à–≤–∏–¥–∫–æ, –µ–Ω–µ—Ä–≥—ñ–π–Ω–æ", "–±—ã—Å—Ç—Ä–æ, —ç–Ω–µ—Ä–≥–∏—á–Ω–æ")
    : style === "calm" ? t(lang, "—Å–ø–æ–∫—ñ–π–Ω–æ, –ø—Ä–µ–º—ñ–∞–ª—å–Ω–æ", "—Å–ø–æ–∫–æ–π–Ω–æ, –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ")
    : t(lang, "–¥—Ä—É–∂–Ω—å–æ, –ø—Ä–æ—Å—Ç–æ", "–¥—Ä—É–∂–µ–ª—é–±–Ω–æ, –ø—Ä–æ—Å—Ç–æ");

  const voiceMode = cfg.voice === "yes"
    ? t(lang, "–û–∑–≤—É—á–∫–∞/–≥–æ–ª–æ—Å: –º–æ–∂–Ω–∞", "–û–∑–≤—É—á–∫–∞/–≥–æ–ª–æ—Å: –º–æ–∂–Ω–æ")
    : t(lang, "–û–∑–≤—É—á–∫–∞/–≥–æ–ª–æ—Å: –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ (—Ç–∏—Ç—Ä–∏)", "–û–∑–≤—É—á–∫–∞/–≥–æ–ª–æ—Å: –Ω–µ –Ω—É–∂–Ω–æ (—Ç–∏—Ç—Ä—ã)");

  const offer = cfg.offer ? cfg.offer : defaultOffer(cfg);

  const structureUk =
`–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: ~${len} —Å–µ–∫ ‚Ä¢ –¢–æ–Ω: ${tone}
${voiceMode}

0‚Äì2—Å (–ì–∞—á–æ–∫): ${hooks[0]}
2‚Äì6—Å (–ü–æ–∫–∞–∑): –ø–æ–∫–∞–∂–∏ ${topic.toLowerCase()} –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑—å–∫–æ (—Ñ–∞–∫—Ç—É—Ä–∞/–¥–æ-–ø—ñ—Å–ª—è/–¥–µ—Ç–∞–ª—å).
6‚Äì12—Å (–ü–µ—Ä–µ–≤–∞–≥–∞): 1‚Äì2 –≤–∏–≥–æ–¥–∏ –ø—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ (–±–µ–∑ ‚Äú–≤–æ–¥–∏‚Äù).
12‚Äì18—Å (–î–æ–≤—ñ—Ä–∞): –∫–æ—Ä–æ—Ç–∫–æ ‚Äî —â–æ —î –ø–æ –¥–æ–≤—ñ—Ä—ñ (–≤–∂–∏–≤—É/–≤—ñ–¥–≥—É–∫–∏/–≥–∞—Ä–∞–Ω—Ç—ñ—è/–æ–±–º—ñ–Ω).
18‚Äì${len}—Å (CTA): ‚Äú–ù–∞–ø–∏—à–∏ ‚Äò${cta}‚Äô ‚Äî ${offer}‚Äù`;

  const structureRu =
`–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ~${len} —Å–µ–∫ ‚Ä¢ –¢–æ–Ω: ${tone}
${voiceMode}

0‚Äì2—Å (–•—É–∫): ${hooks[0]}
2‚Äì6—Å (–ü–æ–∫–∞–∑): –ø–æ–∫–∞–∂–∏ ${topic.toLowerCase()} –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ (—Ñ–∞–∫—Ç—É—Ä–∞/–¥–æ-–ø–æ—Å–ª–µ/–¥–µ—Ç–∞–ª—å).
6‚Äì12—Å (–ü–æ–ª—å–∑–∞): 1‚Äì2 –≤—ã–≥–æ–¥—ã –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ (–±–µ–∑ ‚Äú–≤–æ–¥—ã‚Äù).
12‚Äì18—Å (–î–æ–≤–µ—Ä–∏–µ): –∫–æ—Ä–æ—Ç–∫–æ ‚Äî —á—Ç–æ –µ—Å—Ç—å –ø–æ –¥–æ–≤–µ—Ä–∏—é (–≤–∂–∏–≤—É—é/–æ—Ç–∑—ã–≤—ã/–≥–∞—Ä–∞–Ω—Ç–∏—è/–æ–±–º–µ–Ω).
18‚Äì${len}—Å (CTA): ‚Äú–ù–∞–ø–∏—à–∏ ‚Äò${cta}‚Äô ‚Äî ${offer}‚Äù`;

  return t(lang, structureUk, structureRu);
}

/* ===============================
   Caption + CTA generator
================================ */
function buildCaption(cfg, topic){
  const lang = cfg.lang;
  const p = cfg.product;
  const cta = cfg.ctaWord;

  const offer = cfg.offer ? cfg.offer : defaultOffer(cfg);

  const proofLine =
    cfg.proof === "reviews" ? t(lang,"–Ñ –≤—ñ–¥–≥—É–∫–∏/–ø—Ä–∏–∫–ª–∞–¥–∏ ‚Äî —Å–∫–∏–Ω—É –≤ –¥—ñ—Ä–µ–∫—Ç.","–ï—Å—Ç—å –æ—Ç–∑—ã–≤—ã/–ø—Ä–∏–º–µ—Ä—ã ‚Äî –ø—Ä–∏—à–ª—é –≤ –¥–∏—Ä–µ–∫—Ç.")
    : cfg.proof === "guarantee" ? t(lang,"–Ñ –æ–±–º—ñ–Ω/–≥–∞—Ä–∞–Ω—Ç—ñ—è ‚Äî –ø—ñ–¥–∫–∞–∂—É —É–º–æ–≤–∏.","–ï—Å—Ç—å –æ–±–º–µ–Ω/–≥–∞—Ä–∞–Ω—Ç–∏—è ‚Äî –ø–æ–¥—Å–∫–∞–∂—É —É—Å–ª–æ–≤–∏—è.")
    : cfg.proof === "all" ? t(lang,"–Ñ –≤—ñ–¥–µ–æ –≤–∂–∏–≤—É + –ø—Ä–∏–∫–ª–∞–¥–∏ + —É–º–æ–≤–∏ –æ–±–º—ñ–Ω—É.","–ï—Å—Ç—å –≤–∏–¥–µ–æ –≤–∂–∏–≤—É—é + –ø—Ä–∏–º–µ—Ä—ã + —É—Å–ª–æ–≤–∏—è –æ–±–º–µ–Ω–∞.")
    : t(lang,"–°–∫–∏–Ω—É –≤—ñ–¥–µ–æ/—Ñ–æ—Ç–æ –≤–∂–∏–≤—É ‚Äî —â–æ–± –±—É–ª–æ –≤–∏–¥–Ω–æ —Ñ–∞–∫—Ç—É—Ä—É.","–ü—Ä–∏—à–ª—é –≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ –≤–∂–∏–≤—É—é ‚Äî —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ —Ñ–∞–∫—Ç—É—Ä—É.");

  const ctaLine =
    cfg.ctaMode === "bonus"
      ? t(lang, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî –∑—Ä–æ–±–ª—é –ø—ñ–¥–±—ñ—Ä + –ø—Ä–æ—Ä–∞—Ö—É–Ω–æ–∫ –ø—ñ–¥ —Ç–≤–æ—é –ø–ª–æ—â—É ‚úÖ`, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî —Å–¥–µ–ª–∞—é –ø–æ–¥–±–æ—Ä + —Ä–∞—Å—á—ë—Ç –ø–æ–¥ —Ç–≤–æ—é –ø–ª–æ—â–∞–¥—å ‚úÖ`)
      : cfg.ctaMode === "direct"
      ? t(lang, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî —Å–∫–∞–∂—É —Ü—ñ–Ω—É —Ç–∞ –ø–æ—Ä–∞—Ö—É—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å ‚úÖ`, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî —Å–∫–∞–∂—É —Ü–µ–Ω—É –∏ –ø–æ—Å—á–∏—Ç–∞—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ‚úÖ`)
      : t(lang, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî –ø—ñ–¥–∫–∞–∂—É –≤–∞—Ä—ñ–∞–Ω—Ç —ñ —è–∫ –∫—Ä–∞—â–µ –∑—Ä–æ–±–∏—Ç–∏ ‚úÖ`, `–ù–∞–ø–∏—à–∏ ‚Äú${cta}‚Äù ‚Äî –ø–æ–¥—Å–∫–∞–∂—É –≤–∞—Ä–∏–∞–Ω—Ç –∏ –∫–∞–∫ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å ‚úÖ`);

  const regionLine = cfg.region ? (t(lang,"–†–µ–≥—ñ–æ–Ω: ","–†–µ–≥–∏–æ–Ω: ")+cfg.region) : "";

  const uk =
`${topic}
‚Ä¢ ${t(lang,"–¢–æ–≤–∞—Ä: ","–¢–æ–≤–∞—Ä: ")}${p}
‚Ä¢ ${proofLine}
${regionLine ? ("‚Ä¢ " + regionLine) : ""}

${ctaLine}
`;

  const ru =
`${topic}
‚Ä¢ ${t(lang,"–¢–æ–≤–∞—Ä: ","–¢–æ–≤–∞—Ä: ")}${p}
‚Ä¢ ${proofLine}
${regionLine ? ("‚Ä¢ " + regionLine) : ""}

${ctaLine}
`;

  return t(lang, uk, ru).trim();
}

/* ===============================
   Hashtags generator (generic, not "trending")
================================ */
function buildHashtags(cfg, topic){
  const lang = cfg.lang;
  const mode = cfg.hashtagsMode;

  const baseUk = ["#—ñ–Ω—Ç–µ—Ä—î—Ä","#—Ä–µ–º–æ–Ω—Ç","#–¥–µ–∫–æ—Ä","#–¥—ñ–º","#–∫–æ—Ä–∏—Å–Ω–æ","#–ª–∞–π—Ñ—Ö–∞–∫","#—É–∫—Ä–∞—ó–Ω–∞","#–¥—Ä–æ–ø—à–∏–ø—ñ–Ω–≥"];
  const baseRu = ["#–∏–Ω—Ç–µ—Ä—å–µ—Ä","#—Ä–µ–º–æ–Ω—Ç","#–¥–µ–∫–æ—Ä","#–¥–æ–º","#–ø–æ–ª–µ–∑–Ω–æ","#–ª–∞–π—Ñ—Ö–∞–∫","#—É–∫—Ä–∞–∏–Ω–∞","#–¥—Ä–æ–ø—à–∏–ø–ø–∏–Ω–≥"];

  const pSlug = "#" + slugify(cfg.product);
  const tSlug = "#" + slugify(topic);

  const regionSlug = cfg.region ? ("#" + slugify(cfg.region)) : "";

  let tags = (lang==="ru") ? baseRu.slice() : baseUk.slice();
  tags.push(pSlug);
  tags.push(tSlug);
  if(regionSlug) tags.push(regionSlug);

  // add content-intent tags
  const intent = cfg.goal;
  const extraUk = {
    messages:["#—Ü—ñ–Ω–∞","#–ø—ñ–¥–±—ñ—Ä","#–∑–∞–º–æ–≤–ª–µ–Ω–Ω—è","#–¥–æ—Å—Ç–∞–≤–∫–∞"],
    comments:["#–ø–æ—Ä–∞–¥–∞","#–ø–∏—Ç–∞–Ω–Ω—è","#–¥—É–º–∫–∞","#–æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è"],
    reach:["#–≤—ñ–¥–µ–æ","#—Ä—ñ–ª—Å","#—Ç—ñ–∫—Ç–æ–∫","#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó"]
  };
  const extraRu = {
    messages:["#—Ü–µ–Ω–∞","#–ø–æ–¥–±–æ—Ä","#–∑–∞–∫–∞–∑","#–¥–æ—Å—Ç–∞–≤–∫–∞"],
    comments:["#—Å–æ–≤–µ—Ç","#–≤–æ–ø—Ä–æ—Å","#–º–Ω–µ–Ω–∏–µ","#–æ–±—Å—É–∂–¥–µ–Ω–∏–µ"],
    reach:["#–≤–∏–¥–µ–æ","#—Ä–∏–ª—Å","#—Ç–∏–∫—Ç–æ–∫","#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"]
  };

  const extra = (lang==="ru") ? (extraRu[intent]||[]) : (extraUk[intent]||[]);
  tags = tags.concat(extra);

  // length control
  if(mode === "minimal") tags = tags.slice(0, 8);
  if(mode === "wide") tags = tags.slice(0, 18);
  if(mode === "smart") tags = tags.slice(0, 12);

  // unique
  tags = Array.from(new Set(tags)).filter(Boolean);

  return tags.join(" ");
}

/* ===============================
   DM reply generator
================================ */
function buildDM(cfg){
  const lang = cfg.lang;
  const p = cfg.product;
  const cta = cfg.ctaWord;

  const offer = cfg.offer ? cfg.offer : defaultOffer(cfg);

  const q1 = t(lang,"1) –Ø–∫–∞ –ø–ª–æ—â–∞ (–º¬≤) —ñ —â–æ —Å–∞–º–µ —Ö–æ—á–µ—à –æ–Ω–æ–≤–∏—Ç–∏?","1) –ö–∞–∫–∞—è –ø–ª–æ—â–∞–¥—å (–º¬≤) –∏ —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Ö–æ—á–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å?");
  const q2 = t(lang,"2) –ú—ñ—Å—Ç–æ/–æ–±–ª–∞—Å—Ç—å –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏?","2) –ì–æ—Ä–æ–¥/–æ–±–ª–∞—Å—Ç—å –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏?");
  const q3 = t(lang,"3) –Ñ —Ñ–æ—Ç–æ –º—ñ—Å—Ü—è/—Å—Ç—ñ–Ω–∏/–ø—ñ–¥–ª–æ–≥–∏? (—Å–∫–∏–Ω—å ‚Äî –ø—ñ–¥–±–µ—Ä—É —Ç–æ—á–Ω—ñ—à–µ)","3) –ï—Å—Ç—å —Ñ–æ—Ç–æ –º–µ—Å—Ç–∞/—Å—Ç–µ–Ω—ã/–ø–æ–ª–∞? (—Å–∫–∏–Ω—å ‚Äî –ø–æ–¥–±–µ—Ä—É —Ç–æ—á–Ω–µ–µ)");

  const greet = t(lang,"–ü—Ä–∏–≤—ñ—Ç! üëã –î—è–∫—É—é –∑–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.","–ü—Ä–∏–≤–µ—Ç! üëã –°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ.");
  const ctaLine = t(lang, `–ë–∞—á—É —Å–ª–æ–≤–æ ‚Äú${cta}‚Äù ‚Äî —Å—É–ø–µ—Ä ‚úÖ`, `–í–∏–∂—É —Å–ª–æ–≤–æ ‚Äú${cta}‚Äù ‚Äî —Å—É–ø–µ—Ä ‚úÖ`);
  const value = t(lang, `–ü—ñ–¥–±–µ—Ä—É ${p} –ø—ñ–¥ —Ç–≤–æ—é –∑–∞–¥–∞—á—É —ñ –ø–æ—Ä–∞—Ö—É—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å/–¥–æ—Å—Ç–∞–≤–∫—É.`, `–ü–æ–¥–±–µ—Ä—É ${p} –ø–æ–¥ —Ç–≤–æ—é –∑–∞–¥–∞—á—É –∏ –ø–æ—Å—á–∏—Ç–∞—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ/–¥–æ—Å—Ç–∞–≤–∫—É.`);
  const ask = t(lang,"–ü—ñ–¥–∫–∞–∂–∏, –±—É–¥—å –ª–∞—Å–∫–∞:","–ü–æ–¥—Å–∫–∞–∂–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:");
  const close = t(lang,"–í—ñ–¥–ø–æ–≤—ñ—Å–∏ ‚Äî —ñ —è –æ–¥—Ä–∞–∑—É —Å–∫–∏–Ω—É 2‚Äì3 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –∑ —Ü—ñ–Ω–æ—é ‚úÖ","–û—Ç–≤–µ—Ç–∏—à—å ‚Äî –∏ —è —Å—Ä–∞–∑—É –ø—Ä–∏—à–ª—é 2‚Äì3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å —Ü–µ–Ω–æ–π ‚úÖ");

  return `${greet}\n${ctaLine}\n${value}\n\n${ask}\n${q1}\n${q2}\n${q3}\n\n${close}`;
}

/* ===============================
   Calendar (pace)
================================ */
function isPostingDay(dayIndex1, pace){
  // dayIndex1 is 1..N
  if(pace === "daily") return true;
  // Assume Day 1 is Monday style. For practical use it's okay.
  const dow = ((dayIndex1 - 1) % 7) + 1; // 1..7
  if(pace === "5wk") return dow <= 5; // Mon-Fri
  if(pace === "3wk") return (dow === 1 || dow === 3 || dow === 5);
  return true;
}

/* ===============================
   Build plan items
================================ */
function buildPlan(cfg){
  const rand = makeRand(cfg.seed || "");
  // store seed back so regeneration can reuse
  cfg._seedUsed = rand._seed;

  const lib = buildSeriesLibrary(cfg, rand);

  // product rotation
  const products = (cfg.productsList && cfg.productsList.length) ? cfg.productsList : [cfg.product];

  const plan = [];
  let videoCount = 0;
  let prodIdx = 0;

  for(let day=1; day<=cfg.planDays; day++){
    if(!isPostingDay(day, cfg.pace)){
      plan.push({
        day,
        isPause:true,
        label: t(cfg.lang,"–ü–∞—É–∑–∞ / –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ / —Å—Ç–æ—Ä—ñ—Å","–ü–∞—É–∑–∞ / –æ—Ç–≤–µ—Ç—ã / —Å—Ç–æ—Ä–∏—Å"),
        product: products[prodIdx % products.length]
      });
      continue;
    }

    const useProduct = products[prodIdx % products.length];
    prodIdx++;

    // pick a series from weighted pool
    const s = pick(rand, lib.pool);

    // pick topic from series ideas
    const topic = pick(rand, s.topicIdeas);

    const hooks = buildHooks({...cfg, product: useProduct}, s.name, topic, rand);
    const onscreen = buildOnscreen(cfg, topic);
    const shots = buildShots(cfg, s.type, topic);
    const script = buildScript({...cfg, product: useProduct}, s.name, topic, hooks);
    const caption = buildCaption({...cfg, product: useProduct}, topic);
    const hashtags = buildHashtags({...cfg, product: useProduct}, topic);
    const dm = buildDM({...cfg, product: useProduct});

    const item = {
      id: `${day}_${slugify(s.id)}_${slugify(topic)}`,
      day,
      isPause:false,
      seriesId:s.id,
      seriesName:s.name,
      seriesType:s.type,
      product: useProduct,
      topic,
      hooks,
      onscreen,
      shots,
      script,
      caption,
      hashtags,
      dm,
      meta:{
        platform: cfg.platform,
        goal: cfg.goal,
        timeSlot: cfg.timeSlot,
        lengthSec: cfg.lengthSec,
        face: cfg.face,
        voice: cfg.voice
      }
    };
    plan.push(item);
    videoCount++;
  }

  return {plan, videoCount, seedUsed: cfg._seedUsed};
}

/* ===============================
   Rendering
================================ */
let CURRENT = {
  cfg: null,
  plan: [],
  videoCount: 0,
  seedUsed: "",
  activeTab: "plan"
};

function renderKPIs(){
  const cfg = CURRENT.cfg;
  const videos = CURRENT.videoCount;

  kpis.style.display = "grid";
  kpiVideos.textContent = String(videos);

  // time estimate: each video ~ 8 min shooting+edit (beginner). plus batching.
  const per = cfg.voice === "yes" ? 10 : 8;
  const est = Math.max(1, Math.round((videos * per) / 60 * 10) / 10);
  const estText = t(cfg.lang, `${est} –≥–æ–¥ (–æ—Ä—ñ—î–Ω—Ç–∏—Ä)`, `${est} —á (–æ—Ä–∏–µ–Ω—Ç–∏—Ä)`);
  kpiTime.textContent = estText;

  // series count
  const seriesSet = new Set(CURRENT.plan.filter(x=>!x.isPause).map(x=>x.seriesName));
  kpiSeries.textContent = String(seriesSet.size);
}

function renderPlanTab(){
  const cfg = CURRENT.cfg;
  const plan = CURRENT.plan;

  const headerNote = t(cfg.lang,
    `–ù–∞—Ç–∏—Å–Ω–∏ —Ä—è–¥–æ–∫ ‚Äî –≤—ñ–¥–∫—Ä–∏—é—Ç—å—Å—è –¥–µ—Ç–∞–ª—ñ (–≥–∞—á–∫–∏, —Å–∫—Ä–∏–ø—Ç, –∫–∞–¥—Ä–∏, –æ–ø–∏—Å, DM).`,
    `–ù–∞–∂–º–∏ —Å—Ç—Ä–æ–∫—É ‚Äî –æ—Ç–∫—Ä–æ—é—Ç—Å—è –¥–µ—Ç–∞–ª–∏ (—Ö—É–∫–∏, —Å–∫—Ä–∏–ø—Ç, –∫–∞–¥—Ä—ã, –æ–ø–∏—Å–∞–Ω–∏–µ, DM).`
  );

  let html = `
    <div class="miniText">${headerNote}</div>
    <div class="tableWrap">
      <table>
        <thead>
          <tr>
            <th style="width:70px">${t(cfg.lang,"–î–µ–Ω—å","–î–µ–Ω—å")}</th>
            <th>${t(cfg.lang,"–©–æ –∑–Ω—ñ–º–∞—î–º–æ","–ß—Ç–æ —Å–Ω–∏–º–∞–µ–º")}</th>
            <th style="width:170px">${t(cfg.lang,"–°–µ—Ä—ñ—è","–°–µ—Ä–∏—è")}</th>
            <th style="width:140px">${t(cfg.lang,"–¢–æ–≤–∞—Ä","–¢–æ–≤–∞—Ä")}</th>
            <th style="width:130px">${t(cfg.lang,"CTA","CTA")}</th>
          </tr>
        </thead>
        <tbody>
  `;

  plan.forEach(item=>{
    if(item.isPause){
      html += `
        <tr>
          <td><b>${item.day}</b></td>
          <td colspan="4" style="color:var(--muted)">
            <span class="tag"><i data-lucide="coffee"></i> ${t(cfg.lang,"–ü–∞—É–∑–∞","–ü–∞—É–∑–∞")}</span>
            &nbsp; ${item.label}
          </td>
        </tr>
      `;
      return;
    }

    html += `
      <tr class="rowBtn" data-open="${item.id}">
        <td><b>${item.day}</b></td>
        <td>
          <b style="font-size:13.4px">${item.topic}</b>
          <div class="miniText">
            <span class="tag"><i data-lucide="clock"></i> ~${cfg.lengthSec}s</span>
            <span class="tag"><i data-lucide="upload"></i> ${cfg.timeSlot}</span>
          </div>
        </td>
        <td>${item.seriesName}</td>
        <td>${item.product}</td>
        <td><span class="tag"><i data-lucide="message-circle"></i> ${cfg.ctaWord}</span></td>
      </tr>
    `;
  });

  html += `</tbody></table></div>`;

  tabPlan.innerHTML = html;

  // bind open row
  tabPlan.querySelectorAll("[data-open]").forEach(row=>{
    row.addEventListener("click", ()=>{
      const id = row.getAttribute("data-open");
      const item = CURRENT.plan.find(x=>x.id===id);
      if(item) openDrawer(item);
    });
  });

  if(window.lucide) lucide.createIcons();
}

function renderScriptsTab(){
  const cfg = CURRENT.cfg;
  const plan = CURRENT.plan.filter(x=>!x.isPause);

  let html = `
    <div class="miniText">
      ${t(cfg.lang,"–¢—É—Ç ‚Äî —à–≤–∏–¥–∫–∏–π —Å–ø–∏—Å–æ–∫. –û–±–µ—Ä–∏ 4 –≤—ñ–¥–µ–æ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å —ñ –∑–Ω—ñ–º–∏ –ø–∞—á–∫–æ—é.","–ó–¥–µ—Å—å ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å–ø–∏—Å–æ–∫. –í—ã–±–µ—Ä–∏ 4 –≤–∏–¥–µ–æ –≤ –Ω–µ–¥–µ–ª—é –∏ —Å–Ω–∏–º–∏ –ø–∞—á–∫–æ–π.")}
    </div>
  `;

  plan.slice(0, 999).forEach(item=>{
    const hooksText = item.hooks.map((h,i)=>`${i+1}) ${h}`).join("\n");
    const ons = item.onscreen.map((l,i)=>`${i+1}) ${l}`).join("\n");
    html += `
      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="file-text"></i> –î–µ–Ω—å ${item.day}: ${item.topic}</b>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn secondary" data-copy="mini_${item.id}"><i data-lucide="copy"></i> Copy</button>
            <button class="btn secondary" data-open2="${item.id}"><i data-lucide="maximize-2"></i> –î–µ—Ç–∞–ª—ñ</button>
          </div>
        </div>
        <div class="mono" id="mini_${item.id}">–ì–ê–ß–ö–ò:
${hooksText}

–¢–ï–ö–°–¢ –ù–ê –ï–ö–†–ê–ù–Ü:
${ons}

–°–ö–†–ò–ü–¢:
${item.script}</div>
      </div>
    `;
  });

  tabScripts.innerHTML = html;

  tabScripts.querySelectorAll("[data-copy]").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const id = btn.getAttribute("data-copy");
      const el = document.getElementById(id);
      if(el) copyToClipboard(el.textContent);
    });
  });
  tabScripts.querySelectorAll("[data-open2]").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const id = btn.getAttribute("data-open2");
      const item = CURRENT.plan.find(x=>x.id===id);
      if(item) openDrawer(item);
    });
  });

  if(window.lucide) lucide.createIcons();
}

function renderBatchTab(){
  const cfg = CURRENT.cfg;
  const plan = CURRENT.plan.filter(x=>!x.isPause);

  // Group by series name
  const groups = {};
  plan.forEach(item=>{
    groups[item.seriesName] = groups[item.seriesName] || [];
    groups[item.seriesName].push(item);
  });

  const how = t(cfg.lang,
`–ü–∞—á–∫–∞-–∑–π–æ–º–∫–∞ = 60‚Äì120 —Ö–≤ —ñ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.
1) –û–±–µ—Ä–∏ 4 –≤—ñ–¥–µ–æ
2) –ó–Ω—ñ–º–∏ –≤—Å—ñ ‚Äú–∫–∞–¥—Ä–∏‚Äù —Ä–∞–∑–æ–º
3) –ü–æ—Ç—ñ–º –∑–±–µ—Ä–µ—à —Ä–æ–ª–∏–∫–∏ –≤ CapCut/Editor.`,
`–ü–∞—á–∫–∞-—Å—ä—ë–º–∫–∞ = 60‚Äì120 –º–∏–Ω –∏ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ –Ω–µ–¥–µ–ª—é.
1) –í—ã–±–µ—Ä–∏ 4 –≤–∏–¥–µ–æ
2) –°–Ω–∏–º–∏ –≤—Å–µ ‚Äú–∫–∞–¥—Ä—ã‚Äù –≤–º–µ—Å—Ç–µ
3) –ü–æ—Ç–æ–º —Å–æ–±–µ—Ä—ë—à—å —Ä–æ–ª–∏–∫–∏ –≤ CapCut/Editor.`
  );

  let html = `
    <div class="miniText">${how}</div>
    <div class="block">
      <div class="blockHead">
        <b><i data-lucide="clapperboard"></i> –®–∞–±–ª–æ–Ω –±–∞—Ç—á–∏–Ω–≥—É (–∫–æ–ø—ñ—é–π)</b>
        <button class="btn secondary" id="copyBatchTemplate"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
      </div>
      <div class="mono" id="batchTemplate">${t(cfg.lang,
`–ß–µ–∫-–ª–∏—Å—Ç –ø–∞—á–∫–∞-–∑–π–æ–º–∫–∏ (1‚Äì2 –≥–æ–¥–∏–Ω–∏):
[ ] –û–±—Ä–∞–≤ 4 –≤—ñ–¥–µ–æ –∑ –ø–ª–∞–Ω—É (–î–Ω—ñ: __, __, __, __)
[ ] –ü—ñ–¥–≥–æ—Ç—É–≤–∞–≤ –º—ñ—Å—Ü–µ/—Å–≤—ñ—Ç–ª–æ (–∑–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ)
[ ] –ó–Ω—è–≤ B-roll:
    ‚Äî –∫—Ä—É–ø–Ω—ñ –ø–ª–∞–Ω–∏ —Ñ–∞–∫—Ç—É—Ä–∏
    ‚Äî –∑–∞–≥–∞–ª—å–Ω–∏–π –≤–∏–¥
    ‚Äî ‚Äú–¥–æ/–ø—ñ—Å–ª—è‚Äù (—è–∫—â–æ —î)
    ‚Äî –º–æ–Ω—Ç–∞–∂/–∫–ª–µ–π/–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è
    ‚Äî —É–ø–∞–∫–æ–≤–∫–∞/–∫–æ–º–ø–ª–µ–∫—Ç
[ ] –î–æ–¥–∞–≤ —Ç–∏—Ç—Ä–∏ (3 —Ä—è–¥–∫–∏) + CTA-—Å–ª–æ–≤–æ
[ ] –û–ø—É–±–ª—ñ–∫—É–≤–∞–≤ —É –≤–∏–±—Ä–∞–Ω–∏–π —á–∞—Å
[ ] –ß–µ—Ä–µ–∑ 24 –≥–æ–¥ –ø–æ–¥–∏–≤–∏–≤—Å—è: –¥–µ –±—ñ–ª—å—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å`,
`–ß–µ–∫-–ª–∏—Å—Ç –ø–∞—á–∫–∞-—Å—ä—ë–º–∫–∏ (1‚Äì2 —á–∞—Å–∞):
[ ] –í—ã–±—Ä–∞–ª 4 –≤–∏–¥–µ–æ –∏–∑ –ø–ª–∞–Ω–∞ (–î–Ω–∏: __, __, __, __)
[ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª –º–µ—Å—Ç–æ/—Å–≤–µ—Ç (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
[ ] –°–Ω—è–ª B-roll:
    ‚Äî –∫—Ä—É–ø–Ω—ã–µ –ø–ª–∞–Ω—ã —Ñ–∞–∫—Ç—É—Ä—ã
    ‚Äî –æ–±—â–∏–π –≤–∏–¥
    ‚Äî ‚Äú–¥–æ/–ø–æ—Å–ª–µ‚Äù (–µ—Å–ª–∏ –µ—Å—Ç—å)
    ‚Äî –º–æ–Ω—Ç–∞–∂/–∫–ª–µ–π/–∫—Ä–µ–ø–ª–µ–Ω–∏–µ
    ‚Äî —É–ø–∞–∫–æ–≤–∫–∞/–∫–æ–º–ø–ª–µ–∫—Ç
[ ] –î–æ–±–∞–≤–∏–ª —Ç–∏—Ç—Ä—ã (3 —Å—Ç—Ä–æ–∫–∏) + CTA-—Å–ª–æ–≤–æ
[ ] –û–ø—É–±–ª–∏–∫–æ–≤–∞–ª –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
[ ] –ß–µ—Ä–µ–∑ 24 —á –ø–æ—Å–º–æ—Ç—Ä–µ–ª: –≥–¥–µ –±–æ–ª—å—à–µ —Å–æ–æ–±—â–µ–Ω–∏–π`
      )}</div>
    </div>
  `;

  Object.keys(groups).forEach(seriesName=>{
    const items = groups[seriesName];
    const list = items.map(i=>`‚Ä¢ –î–µ–Ω—å ${i.day}: ${i.topic} (${i.product})`).join("\n");
    html += `
      <div class="block">
        <div class="blockHead">
          <b><i data-lucide="layers-3"></i> ${seriesName} ‚Äî —ñ–¥–µ—ó –≤ –ø–ª–∞–Ω—ñ</b>
          <button class="btn secondary" data-copygrp="${slugify(seriesName)}"><i data-lucide="copy"></i> Copy</button>
        </div>
        <div class="mono" id="grp_${slugify(seriesName)}">${list}</div>
      </div>
    `;
  });

  tabBatch.innerHTML = html;

  const copyBatchTemplate = document.getElementById("copyBatchTemplate");
  copyBatchTemplate.addEventListener("click", ()=>{
    const el = document.getElementById("batchTemplate");
    copyToClipboard(el.textContent);
  });

  tabBatch.querySelectorAll("[data-copygrp]").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const key = btn.getAttribute("data-copygrp");
      const el = document.getElementById("grp_"+key);
      if(el) copyToClipboard(el.textContent);
    });
  });

  if(window.lucide) lucide.createIcons();
}

function renderDMTab(){
  const cfg = CURRENT.cfg;
  const dm = buildDM(cfg);

  const note = t(cfg.lang,
    "–¶–µ —Ç–≤—ñ–π —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π —à–∞–±–ª–æ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –í—ñ–¥–ø—Ä–∞–≤–ª—è–π —Ç–∏–º, —Ö—Ç–æ –Ω–∞–ø–∏—Å–∞–≤ CTA-—Å–ª–æ–≤–æ.",
    "–≠—Ç–æ —Ç–≤–æ–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω –æ—Ç–≤–µ—Ç–∞. –û—Ç–ø—Ä–∞–≤–ª—è–π —Ç–µ–º, –∫—Ç–æ –Ω–∞–ø–∏—Å–∞–ª CTA-—Å–ª–æ–≤–æ."
  );

  const pin = t(cfg.lang,
    `–ö–æ–º–µ–Ω—Ç–∞—Ä –¥–ª—è –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –ø—ñ–¥ –≤—ñ–¥–µ–æ:\n‚Äú–ù–∞–ø–∏—à–∏ –≤ –¥—ñ—Ä–µ–∫—Ç —Å–ª–æ–≤–æ ‚Äò${cfg.ctaWord}‚Äô ‚Äî –ø—ñ–¥–±–µ—Ä—É —ñ –ø–æ—Ä–∞—Ö—É—é ‚úÖ‚Äù`,
    `–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∑–∞–∫—Ä–µ–ø–∞ –ø–æ–¥ –≤–∏–¥–µ–æ:\n‚Äú–ù–∞–ø–∏—à–∏ –≤ –¥–∏—Ä–µ–∫—Ç —Å–ª–æ–≤–æ ‚Äò${cfg.ctaWord}‚Äô ‚Äî –ø–æ–¥–±–µ—Ä—É –∏ –ø–æ—Å—á–∏—Ç–∞—é ‚úÖ‚Äù`
  );

  tabDM.innerHTML = `
    <div class="miniText">${note}</div>

    <div class="block">
      <div class="blockHead">
        <b><i data-lucide="message-square"></i> DM-–≤—ñ–¥–ø–æ–≤—ñ–¥—å (copy/paste)</b>
        <button class="btn secondary" id="copyDMMain"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
      </div>
      <div class="mono" id="dmMain">${dm}</div>
    </div>

    <div class="block">
      <div class="blockHead">
        <b><i data-lucide="pin"></i> –ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –∫–æ–º–µ–Ω—Ç–∞—Ä</b>
        <button class="btn secondary" id="copyPin"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
      </div>
      <div class="mono" id="pinMain">${pin}</div>
    </div>

    <div class="block">
      <div class="blockHead">
        <b><i data-lucide="shield-check"></i> –ú—ñ–Ω—ñ-—Å–∫—Ä–∏–ø—Ç ‚Äú–¥–æ–≤—ñ—Ä–∞‚Äù (1 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è)</b>
        <button class="btn secondary" id="copyTrustMsg"><i data-lucide="copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
      </div>
      <div class="mono" id="trustMsg">${
        t(cfg.lang,
`–©–æ–± –±—É–ª–æ —Å–ø–æ–∫—ñ–π–Ω–æ ‚úÖ
‚Äî –°–∫–∏–Ω—É –≤—ñ–¥–µ–æ/—Ñ–æ—Ç–æ –≤–∂–∏–≤—É (—Ñ–∞–∫—Ç—É—Ä–∞ –≤–∏–¥–Ω–æ)
‚Äî –ü—ñ–¥–∫–∞–∂—É –º–æ–Ω—Ç–∞–∂/–∫–ª–µ–π (—è–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
‚Äî –ü–æ—Ä–∞—Ö—É—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥ –≤–∞—à—É –ø–ª–æ—â—É
–ù–∞–ø–∏—à–∏: –ø–ª–æ—â–∞ + –º—ñ—Å—Ç–æ + —Ñ–æ—Ç–æ –º—ñ—Å—Ü—è üôÇ`,
`–ß—Ç–æ–±—ã –±—ã–ª–æ —Å–ø–æ–∫–æ–π–Ω–æ ‚úÖ
‚Äî –ü—Ä–∏—à–ª—é –≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ –≤–∂–∏–≤—É—é (—Ñ–∞–∫—Ç—É—Ä–∞ –≤–∏–¥–Ω–∞)
‚Äî –ü–æ–¥—Å–∫–∞–∂—É –º–æ–Ω—Ç–∞–∂/–∫–ª–µ–π (–∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
‚Äî –ü–æ—Å—á–∏—Ç–∞—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥ –≤–∞—à—É –ø–ª–æ—â–∞–¥—å
–ù–∞–ø–∏—à–∏: –ø–ª–æ—â–∞–¥—å + –≥–æ—Ä–æ–¥ + —Ñ–æ—Ç–æ –º–µ—Å—Ç–∞ üôÇ`
        )
      }</div>
    </div>
  `;

  document.getElementById("copyDMMain").addEventListener("click", ()=> copyToClipboard(document.getElementById("dmMain").textContent));
  document.getElementById("copyPin").addEventListener("click", ()=> copyToClipboard(document.getElementById("pinMain").textContent));
  document.getElementById("copyTrustMsg").addEventListener("click", ()=> copyToClipboard(document.getElementById("trustMsg").textContent));

  if(window.lucide) lucide.createIcons();
}

function buildAllTextExport(){
  const cfg = CURRENT.cfg;
  const plan = CURRENT.plan;

  const head =
`${t(cfg.lang,"–ü–†–û–Ñ–ö–¢","–ü–†–û–ï–ö–¢")}: ${cfg.projectName || "-"}
${t(cfg.lang,"–ü–õ–ê–¢–§–û–†–ú–ê","–ü–õ–ê–¢–§–û–†–ú–ê")}: ${cfg.platform}
${t(cfg.lang,"–ú–û–í–ê","–Ø–ó–´–ö")}: ${cfg.lang === "ru" ? "RU" : "UA"}
${t(cfg.lang,"–¢–û–í–ê–†","–¢–û–í–ê–†")}: ${cfg.product}
${t(cfg.lang,"CTA-–°–õ–û–í–û","CTA-–°–õ–û–í–û")}: ${cfg.ctaWord}
${cfg.region ? (t(cfg.lang,"–†–ï–ì–Ü–û–ù","–†–ï–ì–ò–û–ù")+": "+cfg.region) : ""}
${t(cfg.lang,"–ü–ï–†–Ü–û–î","–ü–ï–†–ò–û–î")}: ${cfg.planDays} ${t(cfg.lang,"–¥–Ω—ñ–≤","–¥–Ω–µ–π")}
${t(cfg.lang,"–¢–ï–ú–ü","–¢–ï–ú–ü")}: ${cfg.pace}
${t(cfg.lang,"–¢–†–ò–í–ê–õ–Ü–°–¢–¨","–î–õ–ò–¢–ï–õ–¨–ù–û–°–¢–¨")}: ~${cfg.lengthSec}s
Seed: ${CURRENT.seedUsed}

==========================
${t(cfg.lang,"–ü–õ–ê–ù","–ü–õ–ê–ù")}
==========================\n`;

  const lines = plan.map(item=>{
    if(item.isPause){
      return `–î–µ–Ω—å ${item.day}: ${t(cfg.lang,"–ü–∞—É–∑–∞","–ü–∞—É–∑–∞")} ‚Äî ${item.label}`;
    }
    return `–î–µ–Ω—å ${item.day} ‚Äî ${item.topic}
–°–µ—Ä—ñ—è: ${item.seriesName}
–¢–æ–≤–∞—Ä: ${item.product}
–ì–∞—á–∫–∏:
- ${item.hooks[0]}
- ${item.hooks[1]}
- ${item.hooks[2]}
–¢–µ–∫—Å—Ç –Ω–∞ –µ–∫—Ä–∞–Ω—ñ:
- ${item.onscreen[0]}
- ${item.onscreen[1]}
- ${item.onscreen[2]}
–°–∫—Ä–∏–ø—Ç:
${item.script}
–û–ø–∏—Å:
${item.caption}
–•–µ—à—Ç–µ–≥–∏:
${item.hashtags}

DM:
${item.dm}
--------------------------`;
  }).join("\n\n");

  return head + lines;
}

function buildCsv(){
  const cfg = CURRENT.cfg;
  const plan = CURRENT.plan;

  const cols = [
    "day","is_pause","platform","product","series","topic","hook1","hook2","hook3",
    "cta","length_sec","time_slot","caption","hashtags"
  ];

  const esc = (v)=>{
    const s = String(v ?? "");
    const clean = s.replace(/\r?\n/g, " ").replace(/\s+/g, " ").trim();
    return `"${clean.replace(/"/g,'""')}"`;
  };

  const rows = [cols.join(",")];

  plan.forEach(item=>{
    if(item.isPause){
      rows.push([
        item.day, "1", esc(cfg.platform), esc(item.product), esc("PAUSE"), esc(item.label),
        esc(""), esc(""), esc(""),
        esc(cfg.ctaWord), cfg.lengthSec, esc(cfg.timeSlot), esc(""), esc("")
      ].join(","));
      return;
    }

    rows.push([
      item.day, "0",
      esc(cfg.platform),
      esc(item.product),
      esc(item.seriesName),
      esc(item.topic),
      esc(item.hooks[0]),
      esc(item.hooks[1]),
      esc(item.hooks[2]),
      esc(cfg.ctaWord),
      cfg.lengthSec,
      esc(cfg.timeSlot),
      esc(item.caption),
      esc(item.hashtags)
    ].join(","));
  });

  return rows.join("\n");
}

function renderExportTab(){
  const cfg = CURRENT.cfg;

  const txt = buildAllTextExport();
  const csv = buildCsv();
  const json = JSON.stringify({cfg: CURRENT.cfg, plan: CURRENT.plan, seedUsed: CURRENT.seedUsed}, null, 2);

  tabExport.innerHTML = `
    <div class="miniText">
      ${t(cfg.lang,
        "–¢—É—Ç –º–æ–∂–Ω–∞ —à–≤–∏–¥–∫–æ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤—Å–µ –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª. TXT –∑—Ä—É—á–Ω–æ –∫–∏–¥–∞—Ç–∏ —Å–æ–±—ñ –≤ –Ω–æ—Ç–∞—Ç–∫–∏/Telegram.",
        "–¢—É—Ç –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –∏–ª–∏ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª. TXT —É–¥–æ–±–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∑–∞–º–µ—Ç–∫–∏/Telegram."
      )}
    </div>

    <div class="block">
      <div class="blockHead">
        <b><i data-lucide="file-text"></i> TXT (–≤–µ—Å—å –ø—Ä–æ—î–∫—Ç)</b>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn secondary" id="copyTxtAll"><i data-lucide="copy"></i> Copy</button>
          <button class="btn secondary" id="dlTxt"><i data-lucide="download"></i> TXT</button>
        </div>
      </div>
      <div class="mono" id="txtAll">${txt}</div>
    </div>

    <div class="block">
      <div class="blockHead">
        <b><i data-lucide="file-spreadsheet"></i> CSV (–¥–ª—è Excel/Sheets)</b>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn secondary" id="copyCsv"><i data-lucide="copy"></i> Copy</button>
          <button class="btn secondary" id="dlCsv"><i data-lucide="download"></i> CSV</button>
        </div>
      </div>
      <div class="mono" id="csvAll">${csv}</div>
    </div>

    <div class="block">
      <div class="blockHead">
        <b><i data-lucide="braces"></i> JSON (–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è + –ø–ª–∞–Ω)</b>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn secondary" id="copyJson"><i data-lucide="copy"></i> Copy</button>
          <button class="btn secondary" id="dlJson"><i data-lucide="download"></i> JSON</button>
        </div>
      </div>
      <div class="mono" id="jsonAll">${json}</div>
    </div>
  `;

  document.getElementById("copyTxtAll").addEventListener("click", ()=> copyToClipboard(document.getElementById("txtAll").textContent));
  document.getElementById("copyCsv").addEventListener("click", ()=> copyToClipboard(document.getElementById("csvAll").textContent));
  document.getElementById("copyJson").addEventListener("click", ()=> copyToClipboard(document.getElementById("jsonAll").textContent));

  document.getElementById("dlTxt").addEventListener("click", ()=> downloadFile("content_plan.txt", txt, "text/plain;charset=utf-8"));
  document.getElementById("dlCsv").addEventListener("click", ()=> downloadFile("content_plan.csv", csv, "text/csv;charset=utf-8"));
  document.getElementById("dlJson").addEventListener("click", ()=> downloadFile("content_project.json", json, "application/json;charset=utf-8"));

  if(window.lucide) lucide.createIcons();
}

/* ===============================
   Drawer open
================================ */
let CURRENT_ITEM = null;

function openDrawer(item){
  CURRENT_ITEM = item;
  drawer.style.display = "flex";

  dTitle.textContent = `–î–µ–Ω—å ${item.day}: ${item.topic}`;
  dSub.textContent = `${item.seriesName} ‚Ä¢ ${item.product} ‚Ä¢ ${item.meta.platform} ‚Ä¢ ~${item.meta.lengthSec}s`;

  dHooks.textContent = item.hooks.map((h,i)=>`${i+1}) ${h}`).join("\n");
  dScript.textContent = item.script;
  dOnscreen.textContent = item.onscreen.map((l,i)=>`${i+1}) ${l}`).join("\n");
  dShots.textContent = item.shots.map((s,i)=>`‚Ä¢ ${s}`).join("\n");
  dCaption.textContent = item.caption;
  dHashtags.textContent = item.hashtags;
  dDM.textContent = item.dm;

  if(window.lucide) lucide.createIcons();
}

function closeDrawer(){
  drawer.style.display = "none";
  CURRENT_ITEM = null;
}

btnCloseDrawer.addEventListener("click", closeDrawer);
drawer.addEventListener("click", (e)=>{
  if(e.target === drawer) closeDrawer();
});

btnCopyHooks.addEventListener("click", ()=> CURRENT_ITEM && copyToClipboard(dHooks.textContent));
btnCopyScript.addEventListener("click", ()=> CURRENT_ITEM && copyToClipboard(dScript.textContent));
btnCopyOnscreen.addEventListener("click", ()=> CURRENT_ITEM && copyToClipboard(dOnscreen.textContent));
btnCopyShots.addEventListener("click", ()=> CURRENT_ITEM && copyToClipboard(dShots.textContent));
btnCopyCaption.addEventListener("click", ()=> CURRENT_ITEM && copyToClipboard(dCaption.textContent));
btnCopyHashtags.addEventListener("click", ()=> CURRENT_ITEM && copyToClipboard(dHashtags.textContent));
btnCopyDM.addEventListener("click", ()=> CURRENT_ITEM && copyToClipboard(dDM.textContent));

/* ===============================
   Tabs
================================ */
function setTab(name){
  CURRENT.activeTab = name;

  // buttons
  tabs.querySelectorAll(".tab").forEach(t=>{
    t.classList.toggle("active", t.getAttribute("data-tab") === name);
  });

  // panes
  const panes = {
    plan: tabPlan,
    scripts: tabScripts,
    batch: tabBatch,
    dm: tabDM,
    export: tabExport
  };
  Object.keys(panes).forEach(k=> panes[k].style.display = (k===name) ? "block" : "none");

  // title text
  const cfg = CURRENT.cfg;
  if(!cfg || !CURRENT.plan.length){
    outTitle.textContent = t(languageEl.value, "–ü–ª–∞–Ω –Ω–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ", "–ü–ª–∞–Ω –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω");
    outSubtitle.textContent = t(languageEl.value, "–ó–∞–ø–æ–≤–Ω–∏ —Ç–æ–≤–∞—Ä + CTA —ñ –Ω–∞—Ç–∏—Å–Ω–∏ ‚Äú–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏‚Äù.", "–ó–∞–ø–æ–ª–Ω–∏ —Ç–æ–≤–∞—Ä + CTA –∏ –Ω–∞–∂–º–∏ ‚Äú–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å‚Äù.");
    kpis.style.display = "none";
    return;
  }

  const titleMap = {
    plan: t(cfg.lang,"–ö–∞–ª–µ–Ω–¥–∞—Ä –∫–æ–Ω—Ç–µ–Ω—Ç—É","–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞"),
    scripts: t(cfg.lang,"–°–∫—Ä–∏–ø—Ç–∏ —Ç–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∏","–°–∫—Ä–∏–ø—Ç—ã –∏ –∑–∞–≥–æ—Ç–æ–≤–∫–∏"),
    batch: t(cfg.lang,"–ü–∞—á–∫–∞-–∑–π–æ–º–∫–∞","–ü–∞—á–∫–∞-—Å—ä—ë–º–∫–∞"),
    dm: t(cfg.lang,"DM/–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ","DM/–æ—Ç–≤–µ—Ç—ã"),
    export: t(cfg.lang,"–ï–∫—Å–ø–æ—Ä—Ç","–≠–∫—Å–ø–æ—Ä—Ç")
  };

  outTitle.textContent = titleMap[name] || "‚Äî";
  outSubtitle.textContent = `${cfg.platform} ‚Ä¢ ${cfg.planDays} ${t(cfg.lang,"–¥–Ω—ñ–≤","–¥–Ω–µ–π")} ‚Ä¢ CTA: ${cfg.ctaWord} ‚Ä¢ Seed: ${CURRENT.seedUsed}`;
}

tabs.addEventListener("click", (e)=>{
  const tab = e.target.closest(".tab");
  if(!tab) return;
  const name = tab.getAttribute("data-tab");
  setTab(name);
});

/* ===============================
   Generate workflow
================================ */
function validateMinimal(cfg){
  // minimal: product + ctaWord
  const p = String(cfg.product || "").trim();
  const cta = String(cfg.ctaWord || "").trim();
  return p.length > 1 && cta.length > 0;
}

function renderAll(){
  renderKPIs();
  renderPlanTab();
  renderScriptsTab();
  renderBatchTab();
  renderDMTab();
  renderExportTab();
  setTab(CURRENT.activeTab || "plan");
}

function generate(){
  const cfg = getConfig();

  if(!validateMinimal(cfg)){
    alert(t(cfg.lang,
      "–ó–∞–ø–æ–≤–Ω–∏, –±—É–¥—å –ª–∞—Å–∫–∞: –¢–æ–≤–∞—Ä —ñ CTA-—Å–ª–æ–≤–æ. –¶–µ –º—ñ–Ω—ñ–º—É–º üôÇ",
      "–ó–∞–ø–æ–ª–Ω–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞: –¢–æ–≤–∞—Ä –∏ CTA-—Å–ª–æ–≤–æ. –≠—Ç–æ –º–∏–Ω–∏–º—É–º üôÇ"
    ));
    return;
  }

  // if offer empty, keep empty; generator will use default on the fly
  const result = buildPlan(cfg);

  CURRENT.cfg = cfg;
  CURRENT.plan = result.plan;
  CURRENT.videoCount = result.videoCount;
  CURRENT.seedUsed = result.seedUsed;

  // Save state automatically
  saveState();

  renderAll();
  showToast(t(cfg.lang,"–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ ‚úÖ","–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ"));
  if(window.lucide) lucide.createIcons();
}

btnGenerate.addEventListener("click", generate);
btnGenerate2.addEventListener("click", generate);

btnRegenerate.addEventListener("click", ()=>{
  // if seed empty, regenerate will naturally change; if seed set, it will be same.
  if(!seedEl.value.trim()){
    seedEl.value = ""; // keep empty, so new random each time
  }
  generate();
});

btnCopyTab.addEventListener("click", ()=>{
  const cfg = CURRENT.cfg;
  if(!cfg || !CURRENT.plan.length){
    copyToClipboard(t(languageEl.value,"–ù–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤. –°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π –ø–ª–∞–Ω.","–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ø–ª–∞–Ω."));
    return;
  }
  const active = CURRENT.activeTab;

  if(active === "plan"){
    copyToClipboard(tabPlan.textContent);
  }else if(active === "scripts"){
    copyToClipboard(tabScripts.textContent);
  }else if(active === "batch"){
    copyToClipboard(tabBatch.textContent);
  }else if(active === "dm"){
    copyToClipboard(tabDM.textContent);
  }else{
    copyToClipboard(tabExport.textContent);
  }
});

btnCopyAll.addEventListener("click", ()=>{
  const cfg = CURRENT.cfg;
  if(!cfg || !CURRENT.plan.length){
    copyToClipboard(t(languageEl.value,"–ù–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤. –°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π.","–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π."));
    return;
  }
  copyToClipboard(buildAllTextExport());
});

function downloadFile(filename, text, mime){
  const blob = new Blob([text], {type: mime || "text/plain;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

btnDownloadTxt.addEventListener("click", ()=>{
  const cfg = CURRENT.cfg;
  if(!cfg || !CURRENT.plan.length) return alert(t(languageEl.value,"–°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π –ø–ª–∞–Ω üôÇ","–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ø–ª–∞–Ω üôÇ"));
  downloadFile("content_plan.txt", buildAllTextExport(), "text/plain;charset=utf-8");
});
btnDownloadCsv.addEventListener("click", ()=>{
  const cfg = CURRENT.cfg;
  if(!cfg || !CURRENT.plan.length) return alert(t(languageEl.value,"–°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π –ø–ª–∞–Ω üôÇ","–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ø–ª–∞–Ω üôÇ"));
  downloadFile("content_plan.csv", buildCsv(), "text/csv;charset=utf-8");
});
btnDownloadJson.addEventListener("click", ()=>{
  const cfg = CURRENT.cfg;
  if(!cfg || !CURRENT.plan.length) return alert(t(languageEl.value,"–°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π –ø–ª–∞–Ω üôÇ","–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ø–ª–∞–Ω üôÇ"));
  const json = JSON.stringify({cfg: CURRENT.cfg, plan: CURRENT.plan, seedUsed: CURRENT.seedUsed}, null, 2);
  downloadFile("content_project.json", json, "application/json;charset=utf-8");
});

/* ===============================
   Quick start / Help
================================ */
function openHelp(){
  const lang = languageEl.value;
  const msg = t(lang,
`–®–í–ò–î–ö–ò–ô –°–¢–ê–†–¢ (3 –∫—Ä–æ–∫–∏)
1) –í–ø–∏—à–∏ –¢–æ–≤–∞—Ä —ñ CTA-—Å–ª–æ–≤–æ
2) –ù–∞—Ç–∏—Å–Ω–∏ ‚Äú–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏‚Äù
3) –í—ñ–¥–∫—Ä–∏–π ‚Äú–ü–ª–∞–Ω‚Äù ‚Üí –∫–ª—ñ–∫ –ø–æ —Ä—è–¥–∫—É ‚Üí –∫–æ–ø—ñ—é–π –≥–∞—á–æ–∫/—Å–∫—Ä–∏–ø—Ç/–∫–∞–¥—Ä–∏

–ú–Ü–ù–Ü-–ü–†–ê–í–ò–õ–ê (—â–æ–± –±—É–ª–æ –±—ñ–ª—å—à–µ –∑–∞—è–≤–æ–∫)
‚Ä¢ 1 CTA-—Å–ª–æ–≤–æ –Ω–∞ 3‚Äì4 –¥–Ω—ñ (–Ω–µ –º—ñ–Ω—è–π —â–æ–¥–Ω—è)
‚Ä¢ –î–ª—è –Ω–æ–≤–∞—á–∫–∞ –≥–æ–ª–æ–≤–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ ‚Äî –ü–û–í–Ü–î–û–ú–õ–ï–ù–ù–Ø
‚Ä¢ –ó–Ω—ñ–º–∞–π –±–µ–∑ –æ–±–ª–∏—á—á—è: —Ä—É–∫–∏ + —Ç–æ–≤–∞—Ä + ‚Äú–¥–æ/–ø—ñ—Å–ª—è‚Äù
‚Ä¢ –ó—Ä—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤: —á–µ—Ä–µ–∑ 24 –≥–æ–¥

–Ø–∫—â–æ —Ö–æ—á–µ—à: –∑–∞–ø–æ–≤–Ω–∏ ‚Äú–û—Ñ–µ—Ä‚Äù —ñ ‚Äú–ó–∞–ø–µ—Ä–µ—á–µ–Ω–Ω—è‚Äù ‚Äî –±—É–¥–µ —Ç–æ—á–Ω—ñ—à–µ.`,
`–ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ (3 —à–∞–≥–∞)
1) –í–ø–∏—à–∏ –¢–æ–≤–∞—Ä –∏ CTA-—Å–ª–æ–≤–æ
2) –ù–∞–∂–º–∏ ‚Äú–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å‚Äù
3) –û—Ç–∫—Ä–æ–π ‚Äú–ü–ª–∞–Ω‚Äù ‚Üí –∫–ª–∏–∫ –ø–æ —Å—Ç—Ä–æ–∫–µ ‚Üí –∫–æ–ø–∏—Ä—É–π —Ö—É–∫/—Å–∫—Ä–∏–ø—Ç/–∫–∞–¥—Ä—ã

–ú–ò–ù–ò-–ü–†–ê–í–ò–õ–ê (—á—Ç–æ–±—ã –±—ã–ª–æ –±–æ–ª—å—à–µ –∑–∞—è–≤–æ–∫)
‚Ä¢ 1 CTA-—Å–ª–æ–≤–æ –Ω–∞ 3‚Äì4 –¥–Ω—è (–Ω–µ –º–µ–Ω—è–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å)
‚Ä¢ –î–ª—è –Ω–æ–≤–∏—á–∫–∞ –≥–ª–∞–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ ‚Äî –°–û–û–ë–©–ï–ù–ò–Ø
‚Ä¢ –°–Ω–∏–º–∞–π –±–µ–∑ –ª–∏—Ü–∞: —Ä—É–∫–∏ + —Ç–æ–≤–∞—Ä + ‚Äú–¥–æ/–ø–æ—Å–ª–µ‚Äù
‚Ä¢ –°—Ä–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: —á–µ—Ä–µ–∑ 24 —á

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å: –∑–∞–ø–æ–ª–Ω–∏ ‚Äú–û—Ñ—Ñ–µ—Ä‚Äù –∏ ‚Äú–í–æ–∑—Ä–∞–∂–µ–Ω–∏–µ‚Äù ‚Äî –±—É–¥–µ—Ç —Ç–æ—á–Ω–µ–µ.`
  );
  alert(msg);
}

btnQuickStart.addEventListener("click", openHelp);
btnHelpFooter.addEventListener("click", (e)=>{ e.preventDefault(); openHelp(); });

/* ===============================
   Reset
================================ */
function resetAll(){
  const lang = languageEl.value || "uk";
  if(!confirm(t(lang,"–°–∫–∏–Ω—É—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏?","–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã?"))) return;

  // defaults
  setConfig({
    platform:"TikTok",
    lang:"uk",
    product:"",
    ctaWord:"",
    region:"",
    goal:"messages",
    audience:"homeowners",
    priceLevel:"value",
    offer:"",
    proof:"basic",
    objection:"price",
    planDays:14,
    pace:"daily",
    lengthSec:20,
    timeSlot:"evening",
    style:"friendly",
    productsList:[],
    face:"no",
    voice:"no",
    tools:"phone",
    seed:"",
    focusSeries:"balanced",
    hashtagsMode:"smart",
    ctaMode:"soft",
    projectName:""
  });

  CURRENT = {cfg:null, plan:[], videoCount:0, seedUsed:"", activeTab:"plan"};
  localStorage.removeItem(STATE_KEY);
  statePill.innerHTML = '<i data-lucide="save"></i><span>–°—Ç–∞–Ω: –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ</span>';
  kpis.style.display = "none";

  tabPlan.innerHTML = "";
  tabScripts.innerHTML = "";
  tabBatch.innerHTML = "";
  tabDM.innerHTML = "";
  tabExport.innerHTML = "";

  setTab("plan");
  outTitle.textContent = t(lang,"–ü–ª–∞–Ω –Ω–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ","–ü–ª–∞–Ω –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω");
  outSubtitle.textContent = t(lang,"–ó–∞–ø–æ–≤–Ω–∏ —Ç–æ–≤–∞—Ä + CTA —ñ –Ω–∞—Ç–∏—Å–Ω–∏ ‚Äú–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏‚Äù.","–ó–∞–ø–æ–ª–Ω–∏ —Ç–æ–≤–∞—Ä + CTA –∏ –Ω–∞–∂–º–∏ ‚Äú–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å‚Äù.");

  if(window.lucide) lucide.createIcons();
}

btnReset.addEventListener("click", resetAll);

/* ===============================
   State save/restore
================================ */
function saveState(){
  try{
    const cfg = getConfig();
    const state = {
      cfg,
      activeTab: CURRENT.activeTab,
      seedUsed: CURRENT.seedUsed,
      plan: CURRENT.plan,
      videoCount: CURRENT.videoCount,
      ts: Date.now()
    };
    localStorage.setItem(STATE_KEY, JSON.stringify(state));
    statePill.innerHTML = '<i data-lucide="save"></i><span>–°—Ç–∞–Ω: –∑–±–µ—Ä–µ–∂–µ–Ω–æ</span>';
    if(window.lucide) lucide.createIcons();
  }catch(e){}
}

function loadState(){
  try{
    const raw = localStorage.getItem(STATE_KEY);
    if(!raw) return false;
    const st = JSON.parse(raw);
    if(!st || !st.cfg) return false;

    setConfig(st.cfg);

    CURRENT.cfg = st.cfg;
    CURRENT.plan = st.plan || [];
    CURRENT.videoCount = st.videoCount || 0;
    CURRENT.seedUsed = st.seedUsed || "";
    CURRENT.activeTab = st.activeTab || "plan";

    statePill.innerHTML = '<i data-lucide="save"></i><span>–°—Ç–∞–Ω: –∑–±–µ—Ä–µ–∂–µ–Ω–æ</span>';
    return true;
  }catch(e){
    return false;
  }
}

/* ===============================
   Projects (save/load multiple)
================================ */
function loadProjects(){
  try{
    const raw = localStorage.getItem(PROJECTS_KEY);
    const arr = raw ? JSON.parse(raw) : [];
    return Array.isArray(arr) ? arr : [];
  }catch(e){
    return [];
  }
}
function saveProjects(arr){
  localStorage.setItem(PROJECTS_KEY, JSON.stringify(arr));
}

function refreshProjectSelect(){
  const projects = loadProjects();
  projectSelect.innerHTML = "";

  const opt0 = document.createElement("option");
  opt0.value = "";
  opt0.textContent = t(languageEl.value,"‚Äî –æ–±–µ—Ä–∏ –ø—Ä–æ—î–∫—Ç ‚Äî","‚Äî –≤—ã–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç ‚Äî");
  projectSelect.appendChild(opt0);

  projects
    .sort((a,b)=> (b.updatedAt||0) - (a.updatedAt||0))
    .forEach(p=>{
      const o = document.createElement("option");
      o.value = p.id;
      const d = new Date(p.updatedAt || p.createdAt || Date.now());
      const stamp = `${String(d.getDate()).padStart(2,"0")}.${String(d.getMonth()+1).padStart(2,"0")} ${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`;
      o.textContent = `${p.name || t(languageEl.value,"–ë–µ–∑ –Ω–∞–∑–≤–∏","–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è")} ‚Ä¢ ${stamp}`;
      projectSelect.appendChild(o);
    });
}

function saveProject(){
  const cfg = getConfig();
  const name = safeStr(cfg.projectName, t(cfg.lang,"–ú—ñ–π –ø—Ä–æ—î–∫—Ç","–ú–æ–π –ø—Ä–æ–µ–∫—Ç"));

  const projects = loadProjects();

  // if selected exists, update, else new
  const selectedId = projectSelect.value;
  const id = selectedId || ("p_" + Date.now() + "_" + Math.floor(Math.random()*9999));

  const existingIdx = projects.findIndex(x=>x.id===id);
  const payload = {
    id,
    name,
    createdAt: existingIdx >= 0 ? projects[existingIdx].createdAt : Date.now(),
    updatedAt: Date.now(),
    cfg: cfg,
    snapshot: {
      plan: CURRENT.plan || [],
      videoCount: CURRENT.videoCount || 0,
      seedUsed: CURRENT.seedUsed || ""
    }
  };

  if(existingIdx >= 0) projects[existingIdx] = payload;
  else projects.push(payload);

  saveProjects(projects);
  refreshProjectSelect();
  projectSelect.value = id;

  saveState();
  showToast(t(cfg.lang,"–ü—Ä–æ—î–∫—Ç –∑–±–µ—Ä–µ–∂–µ–Ω–æ ‚úÖ","–ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω ‚úÖ"));
}

function loadProject(){
  const id = projectSelect.value;
  if(!id) return;

  const projects = loadProjects();
  const p = projects.find(x=>x.id===id);
  if(!p) return;

  setConfig(p.cfg || {});
  projectName.value = p.name || "";

  // restore snapshot if exists
  if(p.snapshot){
    CURRENT.plan = p.snapshot.plan || [];
    CURRENT.videoCount = p.snapshot.videoCount || 0;
    CURRENT.seedUsed = p.snapshot.seedUsed || "";
  }else{
    CURRENT.plan = [];
    CURRENT.videoCount = 0;
    CURRENT.seedUsed = "";
  }
  CURRENT.cfg = getConfig();

  saveState();
  if(CURRENT.plan.length){
    renderAll();
  }else{
    setTab("plan");
  }
  showToast(t(languageEl.value,"–ü—Ä–æ—î–∫—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ ‚úÖ","–ü—Ä–æ–µ–∫—Ç –∑–∞–≥—Ä—É–∂–µ–Ω ‚úÖ"));
}

function deleteProject(){
  const id = projectSelect.value;
  if(!id) return;

  if(!confirm(t(languageEl.value,"–í–∏–¥–∞–ª–∏—Ç–∏ –≤–∏–±—Ä–∞–Ω–∏–π –ø—Ä–æ—î–∫—Ç?","–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç?"))) return;

  const projects = loadProjects().filter(x=>x.id!==id);
  saveProjects(projects);

  refreshProjectSelect();
  projectSelect.value = "";

  showToast(t(languageEl.value,"–í–∏–¥–∞–ª–µ–Ω–æ ‚úÖ","–£–¥–∞–ª–µ–Ω–æ ‚úÖ"));
}

btnSaveProject.addEventListener("click", saveProject);
btnLoadProject.addEventListener("click", loadProject);
btnDeleteProject.addEventListener("click", deleteProject);

/* ===============================
   Auto-save state on input change (light)
================================ */
let autosaveTimer = null;
document.querySelectorAll("input,select,textarea").forEach(el=>{
  el.addEventListener("input", ()=>{
    clearTimeout(autosaveTimer);
    autosaveTimer = setTimeout(()=> saveState(), 300);
  });
});

/* ===============================
   Init
================================ */
function init(){
  // default config if nothing
  const ok = loadState();
  if(!ok){
    setConfig({
      platform:"TikTok",
      lang:"uk",
      product:"",
      ctaWord:"",
      region:"",
      goal:"messages",
      audience:"homeowners",
      priceLevel:"value",
      offer:"",
      proof:"basic",
      objection:"price",
      planDays:14,
      pace:"daily",
      lengthSec:20,
      timeSlot:"evening",
      style:"friendly",
      productsList:[],
      face:"no",
      voice:"no",
      tools:"phone",
      seed:"",
      focusSeries:"balanced",
      hashtagsMode:"smart",
      ctaMode:"soft",
      projectName:""
    });
    setTab("plan");
  }else{
    if(CURRENT.plan && CURRENT.plan.length){
      renderAll();
    }else{
      setTab(CURRENT.activeTab || "plan");
    }
  }

  refreshProjectSelect();
  if(window.lucide) lucide.createIcons();
}

init();

/* ===============================
   Extra buttons
================================ */
btnCopyTab.addEventListener("click", ()=>{ /* already bound above */ });

/* Copy tab content helper */
function currentTabText(){
  const active = CURRENT.activeTab;
  if(active === "plan") return tabPlan.textContent;
  if(active === "scripts") return tabScripts.textContent;
  if(active === "batch") return tabBatch.textContent;
  if(active === "dm") return tabDM.textContent;
  return tabExport.textContent;
}

/* Export tab copy / download also available in right side */
</script>
</body>
</html>
