<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Кабінет партнера — Samostroy.shop</title>
  <meta name="description" content="Сторінка для дропшиперів: товари з XML, копіювання заголовків і описів, інструкції та спільнота." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#050509;
      --bg2:#0a0b10;
      --card:#11131c;
      --accent:#ff7a1a;
      --accent2:#ffb347;
      --text:#f5f5f7;
      --muted:#9da3b5;
      --border:rgba(255,255,255,.08);
      --shadow:0 14px 45px rgba(0,0,0,.45);
      --radius:16px;
      --radius2:22px;
      --max:1200px;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background: radial-gradient(900px 500px at 75% -10%, rgba(255,122,26,.12), transparent 65%),
                  radial-gradient(900px 500px at 20% 110%, rgba(255,179,71,.10), transparent 60%),
                  linear-gradient(180deg, var(--bg), var(--bg2));
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:var(--max); margin:0 auto; padding:18px;}
    .topbar{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(10px);
      background: rgba(5,5,9,.55);
      border-bottom: 1px solid var(--border);
    }
    .topbar-inner{
      display:flex; align-items:center; justify-content:space-between; gap:14px;
      max-width:var(--max); margin:0 auto; padding:12px 18px;
    }
    .brand{
      display:flex; align-items:center; gap:10px; min-width:220px;
    }
    .logo-dot{
      width:10px; height:10px; border-radius:50%;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow:0 0 22px rgba(255,122,26,.55);
    }
    .brand b{font-size:14px; letter-spacing:.2px}
    .brand small{display:block; color:var(--muted); font-size:12px; margin-top:2px}
    nav{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:center;
    }
    .pill{
      text-decoration:none;
      border:1px solid var(--border);
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      color:var(--text);
      background: rgba(255,255,255,.03);
      transition:.18s ease;
    }
    .pill:hover{transform: translateY(-1px); border-color: rgba(255,122,26,.35)}
    .pill.active{border-color: rgba(255,122,26,.55); box-shadow:0 0 0 3px rgba(255,122,26,.10) inset}

    .hero{
      padding:26px 0 8px;
    }
    .hero-grid{
      display:grid; grid-template-columns: 1.2fr .8fr; gap:14px;
    }
    @media (max-width: 920px){
      .hero-grid{grid-template-columns:1fr}
      .brand{min-width:auto}
    }
    .hero-card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius: var(--radius2);
      padding:18px;
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .hero-card:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(700px 220px at 30% 0%, rgba(255,122,26,.18), transparent 60%);
      pointer-events:none;
    }
    .hero h1{
      margin:0 0 6px;
      font-size:28px;
      letter-spacing:.2px;
      position:relative;
    }
    .hero p{
      margin:0;
      color:var(--muted);
      line-height:1.6;
      position:relative;
    }
    .hero-actions{
      display:flex; gap:10px; flex-wrap:wrap; margin-top:14px; position:relative;
    }
    .btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      font-size:13px;
      cursor:pointer;
      transition:.18s ease;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px); border-color: rgba(255,122,26,.35)}
    .btn.primary{
      border-color: rgba(255,122,26,.55);
      background: linear-gradient(180deg, rgba(255,122,26,.16), rgba(255,255,255,.03));
      box-shadow:0 0 0 3px rgba(255,122,26,.10) inset;
    }
    .meta-card{
      background: rgba(17,19,28,.75);
      border:1px solid var(--border);
      border-radius: var(--radius2);
      padding:18px;
      box-shadow: var(--shadow);
    }
    .meta-card h3{margin:0 0 10px; font-size:14px; letter-spacing:.2px}
    .kpi{
      display:grid; grid-template-columns:1fr 1fr; gap:10px;
    }
    .kpi .box{
      border:1px solid var(--border);
      border-radius: 16px;
      padding:12px;
      background: rgba(255,255,255,.03);
    }
    .kpi .val{font-size:18px; font-weight:800}
    .kpi .lbl{font-size:12px; color:var(--muted); margin-top:4px}

    section{
      padding:18px 0;
    }
    .section-title{
      margin:0 0 12px;
      font-size:18px;
      letter-spacing:.2px;
    }
    .section-sub{
      margin:-6px 0 14px;
      color:var(--muted);
      line-height:1.6;
      font-size:13px;
    }

    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      padding:10px;
      border-radius: 18px;
    }
    .input{
      flex:1;
      min-width:220px;
      border:1px solid var(--border);
      background: rgba(5,5,9,.35);
      color:var(--text);
      padding:10px 12px;
      border-radius: 14px;
      outline:none;
    }
    .select{
      border:1px solid var(--border);
      background: rgba(5,5,9,.35);
      color:var(--text);
      padding:10px 12px;
      border-radius: 14px;
      outline:none;
      min-width:220px;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
      margin-top:12px;
    }
    @media (max-width: 1060px){ .grid{grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 640px){ .grid{grid-template-columns: 1fr;} }

    .card{
      border:1px solid var(--border);
      border-radius: var(--radius2);
      background: rgba(17,19,28,.75);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 220px;
    }
    .card-media{
      height:160px;
      background: rgba(255,255,255,.03);
      display:flex; align-items:center; justify-content:center;
      overflow:hidden;
      border-bottom: 1px solid var(--border);
    }
    .card-media img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .card-body{padding:14px;}
    .title{
      margin:0 0 8px;
      font-size:14px;
      line-height:1.35;
      letter-spacing:.2px;
      font-weight:800;
    }
    .desc{
      margin:0;
      color:var(--muted);
      font-size:12.5px;
      line-height:1.55;
      display:-webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
      overflow:hidden;
      min-height: 78px;
    }
    .badge-row{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top:10px;
    }
    .badge{
      font-size:11px;
      color: rgba(245,245,247,.92);
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      padding:6px 9px;
      border-radius:999px;
    }
    .card-actions{
      padding:12px 14px 14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:auto;
    }
    .mini{
      flex:1;
      min-width: 140px;
      text-align:center;
      border-radius: 14px;
      padding:10px 10px;
      font-size:12.5px;
    }
    .mini.accent{
      border-color: rgba(255,122,26,.55);
      background: linear-gradient(180deg, rgba(255,122,26,.16), rgba(255,255,255,.03));
    }
    .mini.ghost{background: rgba(255,255,255,.03);}
    .mini:active{transform: translateY(1px);}

    .note{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      line-height:1.6;
    }

    .list{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:12px;
    }
    @media (max-width: 820px){ .list{grid-template-columns:1fr;} }
    .list .item{
      border:1px solid var(--border);
      border-radius: var(--radius2);
      background: rgba(17,19,28,.65);
      padding:14px;
      box-shadow: var(--shadow);
    }
    .item h4{margin:0 0 6px; font-size:14px}
    .item p{margin:0; color:var(--muted); font-size:13px; line-height:1.6}
    .item .row{margin-top:10px; display:flex; gap:10px; flex-wrap:wrap}
    .item .row a{
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      font-size:13px;
    }
    footer{
      padding:26px 0 40px;
      color:var(--muted);
      font-size:12px;
      text-align:center;
    }

    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      z-index: 100;
      border: 1px solid var(--border);
      background: rgba(17,19,28,.92);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: var(--shadow);
      transform: translateY(10px);
      opacity: 0;
      pointer-events:none;
      transition: .22s ease;
      max-width: 92vw;
    }
    .toast.show{opacity:1; transform: translateY(0px);}
    .toast b{color:var(--text); font-size:13px}
    .toast span{display:block; color:var(--muted); font-size:12px; margin-top:2px}
  </style>
</head>

<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <span class="logo-dot" aria-hidden="true"></span>
        <div>
          <b>Кабінет партнера</b>
          <small>Дропшипінг / White Label — Samostroy.shop</small>
        </div>
      </div>

      <nav id="nav">
        <a class="pill active" href="#products">Товари</a>
        <a class="pill" href="#post">Де викладати</a>
        <a class="pill" href="#community">Спільнота</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="hero">
      <div class="hero-grid">
        <div class="hero-card">
          <h1>Все для швидкого старту продажів</h1>
          <p>
            Тут ти береш готові товари з нашого каталогу, копіюєш заголовок та опис — і публікуєш на маркетплейсах/дошках оголошень.
            Ніяких зайвих рухів.
          </p>
          <div class="hero-actions">
            <a class="btn primary" href="#products">Відкрити товари</a>
            <a class="btn" href="#post">Де викладати</a>
            <a class="btn" href="#community">Наші соцмережі</a>
          </div>
          <p class="note">Порада: додавай свої фото/відео товару — так оголошення дає більше переглядів.</p>
        </div>

        <div class="meta-card">
          <h3>Статус каталогу</h3>
          <div class="kpi">
            <div class="box">
              <div class="val" id="kpiCount">—</div>
              <div class="lbl">Товарів у списку</div>
            </div>
            <div class="box">
              <div class="val" id="kpiUpdated">—</div>
              <div class="lbl">Останнє оновлення</div>
            </div>
          </div>
          <p class="note" id="feedHint">Завантажуємо XML…</p>
        </div>
      </div>
    </div>

    <!-- 1) ТОВАРЫ -->
    <section id="products">
      <h2 class="section-title">Товари</h2>
      <p class="section-sub">
        Пошук + фільтр по категоріях (категорія береться з XML). Кнопки копіювання — в кожній картці.
      </p>

      <div class="toolbar">
        <input id="search" class="input" placeholder="Пошук по назві або опису…" />
        <select id="category" class="select">
          <option value="__all__">Усі категорії</option>
        </select>
        <button class="btn" id="reloadBtn" type="button">Оновити</button>
      </div>

      <div class="grid" id="grid"></div>
      <p class="note" id="status"></p>
    </section>

    <!-- 2) ГДЕ ВЫКЛАДЫВАТЬ -->
    <section id="post">
      <h2 class="section-title">Де викладати</h2>
      <p class="section-sub">
        Коротко про майданчики + як швидко опублікувати товар. Потім ти це розшириш.
      </p>

      <div class="list">
        <div class="item">
          <h4>OLX</h4>
          <p>Створюєш оголошення → вставляєш заголовок/опис → додаєш фото/відео → вказуєш ціну та місто → публікуєш.</p>
          <div class="row">
            <a href="https://www.olx.ua/" target="_blank" rel="noopener">Відкрити OLX</a>
            <button class="btn" type="button" data-copy="Порада OLX: роби 3–6 фото, додавай відео, в заголовку — ключові слова.">
              Копіювати пораду
            </button>
          </div>
        </div>

        <div class="item">
          <h4>Prom.ua</h4>
          <p>Підійде як “вітрина-магазин”. Додавай товари, категорії, фото, опис, умови доставки та оплати.</p>
          <div class="row">
            <a href="https://prom.ua/" target="_blank" rel="noopener">Відкрити Prom.ua</a>
            <button class="btn" type="button" data-copy="Порада Prom: для кожного товару — 5+ фото, характеристики, ключові слова, доставка/оплата.">
              Копіювати пораду
            </button>
          </div>
        </div>

        <div class="item">
          <h4>Rozetka (маркетплейс)</h4>
          <p>Якщо є можливість підключення — це сильний канал. Потрібні якісні фото, точні характеристики, стабільна логістика.</p>
          <div class="row">
            <a href="https://rozetka.com.ua/" target="_blank" rel="noopener">Відкрити Rozetka</a>
            <button class="btn" type="button" data-copy="Порада Rozetka: максимально точні характеристики + якісні фото, щоб уникати повернень.">
              Копіювати пораду
            </button>
          </div>
        </div>

        <div class="item">
          <h4>Facebook Marketplace / Groups</h4>
          <p>Публікуй у Marketplace та тематичних групах. Працює добре для локальних продажів.</p>
          <div class="row">
            <a href="https://www.facebook.com/marketplace/" target="_blank" rel="noopener">Відкрити Marketplace</a>
            <button class="btn" type="button" data-copy="Порада FB: роби 1 пост під товар + 3–5 груп, додавай фото ‘до/після’ коли можливо.">
              Копіювати пораду
            </button>
          </div>
        </div>
      </div>

      <p class="note">Хочеш — потім додамо окремий блок “Як правильно писати оголошення” + шаблони текстів під кожну платформу.</p>
    </section>

    <!-- 3) СООБЩЕСТВО -->
    <section id="community">
      <h2 class="section-title">Спільнота</h2>
      <p class="section-sub">
        Тут посилання на наші канали та сторінки. Замінюй на свої реальні URL/нікнейми.
      </p>

      <div class="list">
        <div class="item">
          <h4>Telegram канал партнерів</h4>
          <p>Оновлення по товарах, акції, підказки, відповіді на питання.</p>
          <div class="row">
            <a href="#" target="_blank" rel="noopener" id="tgPartners">Додати посилання</a>
            <button class="btn" type="button" data-copy="Напиши мені в Telegram, щоб отримати доступ до партнерського каналу Samostroy.shop">
              Копіювати текст
            </button>
          </div>
        </div>

        <div class="item">
          <h4>TikTok (промо)</h4>
          <p>Відео-огляди, кейси партнерів, мотивація та контент під продажі.</p>
          <div class="row">
            <a href="#" target="_blank" rel="noopener" id="ttPromo">Додати посилання</a>
            <button class="btn" type="button" data-copy="Підписуйся на TikTok Samostroy.shop — там готові ідеї контенту під продажі.">
              Копіювати текст
            </button>
          </div>
        </div>

        <div class="item">
          <h4>Instagram (промо)</h4>
          <p>Сторіс, новинки, приклади робіт, акції та швидкі відповіді.</p>
          <div class="row">
            <a href="#" target="_blank" rel="noopener" id="igPromo">Додати посилання</a>
            <button class="btn" type="button" data-copy="Instagram Samostroy.shop — новинки й ідеї для постів/сторіс під продажі.">
              Копіювати текст
            </button>
          </div>
        </div>

        <div class="item">
          <h4>Facebook</h4>
          <p>Пости, каталоги, групи, Marketplace та оголошення.</p>
          <div class="row">
            <a href="#" target="_blank" rel="noopener" id="fbPromo">Додати посилання</a>
            <button class="btn" type="button" data-copy="Facebook Samostroy.shop — пости та товари, які легко репостити в групи/Marketplace.">
              Копіювати текст
            </button>
          </div>
        </div>
      </div>
    </section>

    <footer>
      © <span id="year"></span> Samostroy.shop — Партнерська сторінка
    </footer>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // === 1) ПУТЬ К XML ===
    const XML_FEED_URL = 'products.xml';

    // === 2) ХРАНЕНИЕ ТОВАРОВ ===
    let allProducts = [];

    // === 3) UI ЭЛЕМЕНТЫ ===
    const gridEl = document.getElementById('grid');
    const statusEl = document.getElementById('status');
    const searchEl = document.getElementById('search');
    const categoryEl = document.getElementById('category');
    const kpiCountEl = document.getElementById('kpiCount');
    const kpiUpdatedEl = document.getElementById('kpiUpdated');
    const feedHintEl = document.getElementById('feedHint');
    const toastEl = document.getElementById('toast');

    document.getElementById('year').textContent = new Date().getFullYear();

    // Меню: подсветка активной секции
    const nav = document.getElementById('nav');
    const navLinks = Array.from(nav.querySelectorAll('a.pill'));
    const sections = navLinks.map(a => document.querySelector(a.getAttribute('href')));

    const obs = new IntersectionObserver((entries) => {
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a,b) => b.intersectionRatio - a.intersectionRatio)[0];
      if(!visible) return;
      const id = '#' + visible.target.id;
      navLinks.forEach(a => a.classList.toggle('active', a.getAttribute('href') === id));
    }, { rootMargin: '-30% 0px -60% 0px', threshold: [0.05, 0.15, 0.25] });

    sections.forEach(s => s && obs.observe(s));

    // === 4) ЗАГРУЗКА XML ===
    async function loadProducts(){
      feedHintEl.textContent = 'Завантажуємо XML…';
      statusEl.textContent = '';

      try{
        const res = await fetch(XML_FEED_URL, { cache: 'no-store' });
        if(!res.ok) throw new Error('Не вдалося завантажити XML: ' + res.status);
        const text = await res.text();

        const parser = new DOMParser();
        const xml = parser.parseFromString(text, 'text/xml');

        // Пытаемся понять формат: либо <item>, либо <offer> (YML), либо что-то подобное
        // Мы вытащим универсально: title/name, description, image, category
        const items =
          Array.from(xml.querySelectorAll('item')).length ? Array.from(xml.querySelectorAll('item')) :
          Array.from(xml.querySelectorAll('offer')).length ? Array.from(xml.querySelectorAll('offer')) :
          Array.from(xml.querySelectorAll('product')).length ? Array.from(xml.querySelectorAll('product')) :
          [];

        if(!items.length){
          allProducts = [];
          render();
          feedHintEl.textContent = 'XML завантажено, але не знайдено елементів товарів (item/offer/product).';
          kpiCountEl.textContent = '0';
          kpiUpdatedEl.textContent = '—';
          return;
        }

        const getText = (node, selectors) => {
          for(const sel of selectors){
            const el = node.querySelector(sel);
            if(el && (el.textContent || '').trim()) return (el.textContent || '').trim();
          }
          return '';
        };

        const getImage = (node) => {
          // частые варианты: <image>, <picture>, <img>, <image_link>, <picture>...
          const byText = getText(node, ['image', 'picture', 'img', 'image_link', 'imageUrl', 'image_url']);
          if(byText) return byText;

          // иногда бывает как атрибут
          const attr = node.getAttribute('image') || node.getAttribute('picture') || '';
          return attr.trim();
        };

        allProducts = items.map((it, idx) => {
          const title = getText(it, ['title', 'name', 'vendor.model', 'model', 'h1', 'fullName']) || ('Товар #' + (idx+1));
          const description = getText(it, ['description', 'desc', 'full_description', 'text']) || '';
          const category = getText(it, ['category', 'categoryId', 'category_id', 'group', 'type']) || 'Без категорії';
          const image = getImage(it);

          return {
            id: getText(it, ['id']) || it.getAttribute('id') || String(idx+1),
            title,
            description,
            category,
            image
          };
        });

        // KPI
        kpiCountEl.textContent = String(allProducts.length);

        // "обновлено" — точной даты в XML может не быть, поэтому показываем сегодняшнюю
        const d = new Date();
        kpiUpdatedEl.textContent = d.toLocaleDateString('uk-UA', { year:'numeric', month:'2-digit', day:'2-digit' });

        // Категории
        buildCategoryOptions(allProducts);

        feedHintEl.textContent = 'XML успішно завантажено.';
        render();

      }catch(err){
        allProducts = [];
        render();
        feedHintEl.textContent = 'Помилка завантаження XML.';
        statusEl.textContent = 'Помилка: ' + (err?.message || err);
      }
    }

    function buildCategoryOptions(products){
      const uniq = new Set();
      products.forEach(p => uniq.add((p.category || 'Без категорії').trim()));
      const sorted = Array.from(uniq).sort((a,b) => a.localeCompare(b, 'uk'));

      // очищаем, оставляя первый option
      while(categoryEl.options.length > 1) categoryEl.remove(1);

      sorted.forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat;
        opt.textContent = cat;
        categoryEl.appendChild(opt);
      });
    }

    // === 5) РЕНДЕР ===
    function escapeHTML(str){
      return (str || '').replace(/[&<>"']/g, (c) => ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'
      }[c]));
    }

    function normalize(str){
      return (str || '').toLowerCase().replace(/\s+/g,' ').trim();
    }

    function getFiltered(){
      const q = normalize(searchEl.value);
      const cat = categoryEl.value;

      return allProducts.filter(p => {
        const inCat = (cat === '__all__') || ((p.category || 'Без категорії').trim() === cat);
        if(!inCat) return false;
        if(!q) return true;
        const hay = normalize(p.title + ' ' + p.description);
        return hay.includes(q);
      });
    }

    function render(){
      const list = getFiltered();
      gridEl.innerHTML = '';

      if(!list.length){
        gridEl.innerHTML = '';
        statusEl.textContent = allProducts.length ? 'Нічого не знайдено за фільтрами.' : 'Каталог порожній.';
        return;
      }

      const frag = document.createDocumentFragment();

      list.forEach(p => {
        const card = document.createElement('article');
        card.className = 'card';

        const media = document.createElement('div');
        media.className = 'card-media';

        if(p.image){
          const img = document.createElement('img');
          img.loading = 'lazy';
          img.alt = p.title;
          img.src = p.image;
          media.appendChild(img);
        } else {
          media.innerHTML = '<div class="badge">Без фото</div>';
        }

        const body = document.createElement('div');
        body.className = 'card-body';
        body.innerHTML = `
          <h3 class="title">${escapeHTML(p.title)}</h3>
          <p class="desc">${escapeHTML(p.description || 'Опис ще не додано в XML.')}</p>
          <div class="badge-row">
            <span class="badge">${escapeHTML((p.category || 'Без категорії').trim())}</span>
            <span class="badge">ID: ${escapeHTML(p.id)}</span>
          </div>
        `;

        const actions = document.createElement('div');
        actions.className = 'card-actions';

        const btnTitle = document.createElement('button');
        btnTitle.className = 'btn mini accent';
        btnTitle.type = 'button';
        btnTitle.textContent = 'Копіювати заголовок';
        btnTitle.addEventListener('click', () => copyText(p.title, 'Заголовок скопійовано', p.title));

        const btnDesc = document.createElement('button');
        btnDesc.className = 'btn mini ghost';
        btnDesc.type = 'button';
        btnDesc.textContent = 'Копіювати опис';
        btnDesc.addEventListener('click', () => copyText(p.description || '', 'Опис скопійовано', (p.description || '')));

        actions.appendChild(btnTitle);
        actions.appendChild(btnDesc);

        card.appendChild(media);
        card.appendChild(body);
        card.appendChild(actions);

        frag.appendChild(card);
      });

      gridEl.appendChild(frag);
      statusEl.textContent = `Показано: ${list.length} / ${allProducts.length}`;
    }

    // === 6) КОПИРОВАНИЕ ===
    async function copyText(text, title, preview){
      const value = (text || '').trim();
      if(!value){
        toast('Нічого копіювати', 'Поле порожнє.');
        return;
      }

      try{
        await navigator.clipboard.writeText(value);
        toast(title, (preview || '').slice(0, 120));
      }catch(e){
        // Фоллбек для старых браузеров
        const ta = document.createElement('textarea');
        ta.value = value;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(ta);

        if(ok) toast(title, (preview || '').slice(0, 120));
        else toast('Помилка копіювання', 'Спробуй вручну виділити текст.');
      }
    }

    // Кнопки с data-copy (в инструкциях/сообществе)
    document.querySelectorAll('[data-copy]').forEach(btn => {
      btn.addEventListener('click', () => copyText(btn.getAttribute('data-copy'), 'Текст скопійовано', btn.getAttribute('data-copy')));
    });

    // === 7) TOAST ===
    let toastTimer = null;
    function toast(t, s){
      toastEl.innerHTML = `<b>${escapeHTML(t)}</b><span>${escapeHTML(s || '')}</span>`;
      toastEl.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toastEl.classList.remove('show'), 2200);
    }

    // === 8) EVENTS ===
    searchEl.addEventListener('input', () => render());
    categoryEl.addEventListener('change', () => render());
    document.getElementById('reloadBtn').addEventListener('click', () => loadProducts());

    // === 9) START ===
    loadProducts();
  </script>
</body>
</html>
